<?php

echo "<!DOCTYPE html>\r\n<!--\r\nTo change this license header, choose License Headers in Project Properties.\r\nTo change this template file, choose Tools | Templates\r\nand open the template in the editor.\r\n-->\r\n<html>\r\n    <head>\r\n        <title>";
echo $_SESSION["page_title"];
echo " Categories</title>\r\n        <meta charset=\"UTF-8\">\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n        <link rel=\"icon\" type=\"image/png\" href=\"resources/favicon.png\">\r\n\r\n        <script src=\"libraries/jquery-3.1.1.min.js\" type=\"text/javascript\"></script>\r\n\r\n        <script src=\"libraries/bootstrap-3.3.7-dist/js/bootstrap.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-3.3.7-dist/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/js/jquery.dataTables.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/js/dataTables.bootstrap.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/css/dataTables.bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n\r\n                <script src=\"application/mvc/views/custom_libraries/javascripts/shortcuts.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n\r\n         \r\n        <script src=\"libraries/bootstrap-plugins/bootstrap-select-master/bootstrap-select-master/dist/js/bootstrap-select.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-plugins/bootstrap-select-master/bootstrap-select-master/dist/css/bootstrap-select.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/extensions/Select/js/dataTables.select.min.js\" type=\"text/javascript\"></script>\r\n\r\n        \r\n        <link href=\"libraries/bootstrap-plugins/export/buttons.dataTables.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <script src=\"libraries/bootstrap-plugins/export/dataTables.buttons.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/export/jszip.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/export/vfs_fonts.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/export/buttons.html5.min.js\" type=\"text/javascript\"></script>\r\n        \r\n        \r\n        <script src=\"libraries/bootstrap-plugins/Buttons-1.2.4/js/buttons.bootstrap.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-plugins/Buttons-1.2.4/css/buttons.bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/global_functions.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/global.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n\r\n        <script src=\"libraries/bootstrap-plugins/bootstrap-select-master/bootstrap-select-master/dist/js/bootstrap-select.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"application/mvc/views/custom_libraries/css/global.css?rnd=";
echo self::generateRandomStringComplex();
echo "\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        <script src=\"libraries/bootstrap-plugins/libs/bootstrap-confirmation.min.js\" type=\"text/javascript\"></script>\r\n    <script src=\"application/mvc/views/custom_libraries/javascripts/unique_items.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/jquery-confirm.min.js\"\r\n        type=\"text/javascript\"></script>\r\n    <link href=\"application/mvc/views/custom_libraries/css/jquery-confirm.min.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n    \r\n        <script src=\"libraries/bootstrap-plugins/bootstrap3-typeahead/bootstrap3-typeahead.min.js\" type=\"text/javascript\"></script>\r\n        \r\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/extensions/KeyTable/js/dataTables.keyTable.min.js\" type=\"text/javascript\"></script>\r\n        \r\n        <script src=\"libraries/bootstrap-plugins/bootstrap-sweetalert-master/dist/sweetalert.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-plugins/bootstrap-sweetalert-master/dist/sweetalert.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <script src=\"libraries/numeric.js\" type=\"text/javascript\"></script>\r\n        \r\n        <link href=\"libraries/bootstrap-plugins/datepicker-master/dist/css/bootstrap-datepicker.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <script src=\"libraries/bootstrap-plugins/datepicker-master/dist/js/bootstrap-datepicker.min.js\" type=\"text/javascript\"></script>\r\n        \r\n        <link href=\"application/mvc/views/custom_libraries/css/select2.min.css?v=2\" rel=\"stylesheet\" type=\"text/css\" />\r\n    <script src=\"application/mvc/views/custom_libraries/javascripts/select2.full.min.js\" type=\"text/javascript\"></script>\r\n    \r\n        <link href=\"application/mvc/views/custom_libraries/svgs/font/style.css?rnd=";
echo self::generateRandomStringComplex();
echo "\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        <link href=\"libraries/bootstrap-plugins/bootstrap-colorpicker-master/dist/css/bootstrap-colorpicker.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <script src=\"libraries/bootstrap-plugins/bootstrap-colorpicker-master/dist/js/bootstrap-colorpicker.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/autocomplete.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/store_items.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/cleave.js-master/dist/cleave.min.js\" type=\"text/javascript\"></script>\r\n        \r\n        <script\r\n        src=\"application/mvc/views/custom_libraries/javascripts/multiple_branches.js?rnd=";
echo self::generateRandomStringComplex();
echo "\"\r\n        type=\"text/javascript\"></script>\r\n         \r\n        <style type=\"text/css\">\r\n            .container,.panel {\r\n                height:100%;\r\n                width: 100%;\r\n                padding: 0px !important;\r\n                margin: 0px !important;\r\n            }\r\n            \r\n            \r\n            .table>tfoot>tr>th{\r\n                font-size: 12px !important;\r\n                background-color: #F3F3F3;\r\n                padding: 2px;\r\n                border: none !important;\r\n            }\r\n            \r\n            .table>tbody>tr>td{\r\n                height: 21px !important;\r\n            }\r\n            \r\n            .dataTables_filter { display: none; }\r\n            \r\n            .input-sm{\r\n               \r\n            }\r\n            \r\n            .selected{\r\n                background-color: #337ab7 !important;\r\n                color: #ffffff !important;\r\n            }\r\n            \r\n            .selected .glyphicon-trash{\r\n                color: #fff !important;\r\n            }\r\n            \r\n            .search_filter{\r\n                width: 100% !important;\r\n                color: #000;\r\n                \r\n            }\r\n            \r\n            \r\n            \r\n            ::-webkit-input-placeholder { /* Chrome/Opera/Safari */\r\n                color: #337ab7;\r\n                opacity: 0.9;\r\n            }\r\n            ::-moz-placeholder { /* Firefox 19+ */\r\n                color: #337ab7;\r\n                opacity: 0.9;\r\n            }\r\n            :-ms-input-placeholder { /* IE 10+ */\r\n                color: #337ab7;\r\n                opacity: 0.9;\r\n            }\r\n            :-moz-placeholder { /* Firefox 18- */\r\n                color: #337ab7;\r\n                opacity: 0.9;\r\n            }\r\n            \r\n            /* enable absolute positioning */\r\n            .inner-addon { \r\n                position: relative; \r\n            }\r\n\r\n            /* style icon */\r\n            .inner-addon .glyphicon {\r\n              position: absolute;\r\n              padding: 6px;\r\n              pointer-events: none;\r\n            }\r\n\r\n            /* align icon */\r\n            .left-addon .glyphicon  { left:  0px;}\r\n            .right-addon .glyphicon { right: 0px;}\r\n\r\n            /* add padding  */\r\n            \r\n            .left-addon input  { padding-left:  5px; }\r\n            .right-addon input { padding-right: 5px; }\r\n            \r\n            \r\n            .phone-input{\r\n                    margin-bottom:8px;\r\n            }\r\n            \r\n            .confirmation {\r\n                width: 160px;\r\n            }\r\n            \r\n            .list-group-item{\r\n                border: none !important;\r\n            }\r\n            \r\n            div.toolbar h3{\r\n                margin-top: 0px !important;\r\n            }\r\n            \r\n            div.toolbars h3{\r\n                margin-top: 0px !important;\r\n            }\r\n            \r\n            .dataTable>tfoot>tr>th{\r\n                /* width: 50px !important; */\r\n            }\r\n            \r\n            .item_icon{\r\n                font-size: 18px;\r\n            }\r\n            .addon_item_icon input{\r\n                padding-left: 30px !important;\r\n            }\r\n            \r\n            .show_items{\r\n                padding: 1px !important;\r\n                font-size: 13px !important;\r\n                width: 100%;\r\n            }\r\n            \r\n            .show_items:parent{\r\n                padding: 0px !important;\r\n            }\r\n            \r\n            #showItemsBySubCat .modal-dialog {\r\n                width: 99% !important;\r\n            }\r\n            \r\n             #exTab1 .tab-content {\r\n                background-color: transparent;\r\n                padding : 15px 15px;\r\n                border-bottom: 1px solid #CCC;\r\n                border-left: 1px solid #CCC;\r\n                border-right: 1px solid #CCC;\r\n                border-top: 1px solid #CCC;\r\n            }\r\n\r\n            #exTab1 .nav-pills > li > a {\r\n                border-radius: 4px 4px 0 0;\r\n                border: 1px solid #CCC;\r\n                border-bottom: 0px solid #CCC;\r\n                padding-top: 5px;\r\n                padding-bottom: 5px;\r\n            }\r\n        </style>\r\n\r\n        <script type=\"text/javascript\"> \r\n            var categories_table = null;\r\n            var parent_categories_table = null;\r\n            var default_currency_symbol = null;\r\n            var current_store_id = ";
echo $_SESSION["store_id"];
echo ";\r\n            \r\n            var multi_branches = ";
echo $data["enable_new_multibranches"];
echo ";\r\n            \r\n            var mobile_shop = \"";
echo $data["mobile_shop"];
echo "\";\r\n            \r\n            var stores = [];\r\n            \r\n            var hide_critical_data=";
echo $_SESSION["hide_critical_data"];
echo ";\r\n            \r\n            var enable_wholasale = ";
echo $data["enable_wholasale"];
echo ";\r\n            var print_barcode_in_browser = ";
echo $data["print_barcode_in_browser"];
echo ";\r\n            \r\n            var vatValue = ";
echo $data["vat"];
echo ";\r\n            \r\n            var sore_id_ = ";
echo $_SESSION["store_id"];
echo ";\r\n             var ptype = ";
echo $_SESSION["ptype"];
echo ";\r\n             \r\n             var  ptype_hide = \";display:block;\";\r\n            ";
if ($_SESSION["ptype"] == 1) {
    echo "                ptype_hide = \";display:none;\";\r\n            ";
}
echo "            \r\n            var disabled_action = 0;\r\n            var disabled_logo = \"\";\r\n            var syn_btn = \"\";\r\n            ";
if ($_SESSION["global_admin_exist"] && ($_SESSION["centralize"] == 0 || WAREHOUSE_CONNECTED == 1)) {
    echo "               disabled_action = 1;\r\n               disabled_logo = \"<i class='glyphicon glyphicon-lock locked_css'></i>\";\r\n               syn_btn = \"<button onclick='go_sync(\"+sore_id_+\")' type='button' class='btn btn-warning' style='width:100%'>Sync Data</button>\";\r\n            ";
}
echo "            \r\n            \r\n            function updateRowsDetails_categories_parent(){\r\n                var table = \$('#parent_categories_table').DataTable();\r\n                var p = table.rows({ page: 'current' }).nodes();\r\n                for (var k = 0; k < p.length; k++){\r\n                    var index = table.row(p[k]).index();\r\n                    table.cell(index, 3).data('<i onclick=\"editParentCategory_new('+parseInt(table.cell(index, 0).data().split(\"-\")[1])+')\" title=\"Edit\" class=\"glyphicon glyphicon-edit edit_icon\"></i>&nbsp;&nbsp;<i style=\"cursor:pointer\" onclick=\"\" title=\"Open\" class=\"glyphicon glyphicon-folder-open\"></i>&nbsp;&nbsp;<i onclick=\"delete_parent('+parseInt(table.cell(index, 0).data().split(\"-\")[1])+')\" title=\"Delete\" class=\"glyphicon glyphicon-trash trash_icon red\"></i>');\r\n                }\r\n            }\r\n            \r\n            \r\n            function delete_parent(id){\r\n            \r\n                \$.confirm({\r\n                    title: 'Delete Category!',\r\n                    content: 'Are you sure?',\r\n                    animation: 'zoom',\r\n                    closeAnimation: 'zoom',\r\n                    animateFromElement:false,\r\n                    buttons: {\r\n                        DELETE: {\r\n                            btnClass: 'btn-danger',\r\n                            action: function(){\r\n                                \$(\".sk-circle-layer\").show();\r\n                                \$.getJSON(\"?r=categories&f=delete_parent_category&p0=\"+id , function (data) {\r\n                                  \r\n                                    if(data.status>0){\r\n                                        location.reload();\r\n                                    }\r\n                                    if(data.status==-1){\r\n                                        \$.confirm({\r\n                                            title: '<b class=\"text-danger\">Unable to delete!</b>',\r\n                                            content: 'Unable to delete the main category',\r\n                                            animation: 'zoom',\r\n                                            closeAnimation: 'zoom',\r\n                                            animateFromElement:false,\r\n                                            buttons: {\r\n                                                somethingElse: {\r\n                                                    text: 'Close',\r\n                                                    btnClass: 'btn-blue',\r\n                                                    action: function(){\r\n\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        });\r\n                                    }\r\n                                    if(data.status==0){\r\n                                        \$.confirm({\r\n                                            title: '<b class=\"text-danger\">Unable to delete!</b>',\r\n                                            content: 'Unable to delete category that contains subcategories',\r\n                                            animation: 'zoom',\r\n                                            closeAnimation: 'zoom',\r\n                                            animateFromElement:false,\r\n                                            buttons: {\r\n                                                somethingElse: {\r\n                                                    text: 'Close',\r\n                                                    btnClass: 'btn-blue',\r\n                                                    action: function(){\r\n\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        });\r\n                                    }\r\n                                        \r\n                                    \r\n\r\n                                }).done(function () {\r\n                                    \$(\".sk-circle-layer\").hide();\r\n                                });\r\n                            }\r\n                        },\r\n                        CANCEL: {\r\n                            btnClass: 'btn-default any-other-class', // multiple classes.\r\n                            action: function(){\r\n\r\n                            }\r\n                        },\r\n                    }\r\n                });\r\n            \r\n                \r\n                \r\n            }\r\n            \r\n            function init(){\r\n                \$('#categories_table').show();\r\n                \r\n                \$(\".sk-circle\").center();\r\n                \$(\".sk-circle-layer\").show();\r\n                \r\n                var search_fields = [0,1,2,3];\r\n                var index = 0;\r\n                \$('#categories_table tfoot th').each( function () {\r\n                    if(jQuery.inArray(index, search_fields) !== -1){\r\n                        var title = \$(this).text();\r\n                        \$(this).html( '<div class=\"inner-addon left-addon\"><input style=\"width: 100% !important;\"  class=\"form-control input_sm_search\" type=\"text\" placeholder=\" '+title+'\" /></div>' );\r\n                        index++;\r\n                    }\r\n                });\r\n                \r\n                \r\n                var parent_search_fields = [0,1,2];\r\n                var sub_index = 0;\r\n                \$('#parent_categories_table tfoot th').each( function () {\r\n                    if(jQuery.inArray(sub_index, parent_search_fields) !== -1){\r\n                        var title = \$(this).text();\r\n                        \$(this).html( '<div class=\"inner-addon left-addon\"><input style=\"width: 100% !important;\"  class=\"form-control input_sm_search\" type=\"text\" placeholder=\" '+title+'\" /></div>' );\r\n                        sub_index++;\r\n                    }\r\n                });\r\n                \r\n                parent_categories_table = \$('#parent_categories_table').dataTable({\r\n                    ajax: \"?r=categories&f=getAllParentCategories\",\r\n                    orderCellsTop: true,\r\n                    aoColumnDefs: [\r\n                        { \"targets\": [0], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                        { \"targets\": [1], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                        { \"targets\": [2], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                        { \"targets\": [3], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                    ],\r\n                    scrollY: '47vh',\r\n                    scrollCollapse: true,\r\n                    \"paging\": true,           // Enable pagination\r\n                    \"pageLength\": 50, \r\n                    \"lengthChange\": true,\r\n                    \"lengthMenu\": [50, 100, 250, 500], // Page length options \r\n                    //dom: '<\"toolbar\">frtlip',\r\n                    dom: '<\"row\"<\"col-sm-12 col-md-12\"<\"toolbars\">>><\"row\"<\"col-sm-12 col-md-6\"f>>' +\r\n                    '<\"row\"<\"col-sm-12\"tr>>' +\r\n                    '<\"row\"<\"col-sm-6 col-md-6\"i><\"col-sm-6 col-md-6\"p>>',\r\n                    initComplete: function( settings ) {\r\n                        var table = \$('#parent_categories_table').DataTable();\r\n                        table.row(':eq(0)', { page: 'current' }).select();\r\n                        \r\n                        \r\n                        \$(\"div.toolbars\").html('<h3><i class=\"glyphicon glyphicon-modal-window\" style=\"font-size:22px;\"></i>&nbsp;Define Categories/Sub-Categories</h3><div id=\"tab_toolbar1\" class=\"btn-group\" role=\"group\" aria-label=\"\">\\n\\\r\n                            <button onclick=\"addParentCategory_()\" type=\"button\" class=\"btn btn-primary  \"><i class=\"glyphicon glyphicon-plus\"></i>&nbsp;Add Category</button>\\n\\\r\n                        </div>\\n\\\r\n                        ');\r\n    \r\n                        if(table.rows().count()==0)\r\n                            \$(\"#tab_toolbar1 button.blueB\").addClass(\"disabled\");\r\n                        \r\n                       /*\r\n                        \$('[data-toggle=confirmation]').confirmation({\r\n                            rootSelector: '[data-toggle=confirmation]',\r\n                            placement: 'right',\r\n                            onConfirm: function() {\r\n                                if(disabled_action==0){\r\n                                    var dt = \$('#parent_categories_table').DataTable();\r\n                                    var id = dt.row('.selected', 0).data();\r\n\r\n                                    if(\$(\"#tab_toolbar1 button.blueB\").hasClass(\"disabled\")==false){\r\n                                        \$(\".sk-circle-layer\").show();\r\n                                        \$.getJSON(\"?r=categories&f=delete_parent_category&p0=\"+parseInt(id[0].split('-')[1]) , function (data) {\r\n                                            if(!data.status){\r\n                                                \$(\".sk-circle-layer\").hide();\r\n                                                swal(\"Unable to delete!\", \"Please contact system administrator\", \"warning\");\r\n                                            }else{\r\n                                                dt.row('.selected').remove().draw( false );\r\n                                                \$(\"#tab_toolbar1 button.blueB\").addClass(\"disabled\");\r\n                                                \$(\".sk-circle-layer\").hide();\r\n                                                swal(\"\", \"Category has been deleted.\", \"success\");\r\n                                            }\r\n\r\n                                        }).done(function () {\r\n\r\n                                        });\r\n                                    }\r\n                                }else{\r\n                                     swal(\"Function Disabled\");\r\n                                }\r\n                            },\r\n                            onCancel: function() {\r\n                                \r\n                            },\r\n                            // other options\r\n                        });*/\r\n                       \r\n                        \$(\".sk-circle-layer\").hide();\r\n                        \r\n                        \r\n                            \r\n                        \r\n                            \r\n                        \r\n                    },\r\n                     fnDrawCallback: updateRowsDetails_categories_parent,\r\n                    fnRowCallback: function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {\r\n                        \$(nRow).addClass(aData[0]);\r\n                    },\r\n                   \r\n                });\r\n            \r\n            \r\n            //var dt = \$('#parent_categories_table').DataTable();\r\n                        //var sdata = dt.row('.selected', 0).data();\r\n                        //update_categories(parseInt(sdata[0].split('-')[1]));\r\n                \r\n                categories_table = \$('#categories_table').dataTable({\r\n                    ajax: '?r=categories&f=getAllCategoriesByParent&p0=1&p1='+current_store_id,\r\n                    orderCellsTop: true,\r\n                    aoColumnDefs: [\r\n                        { \"targets\": [0], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                        { \"targets\": [1], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                        { \"targets\": [2], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                        { \"targets\": [3], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                        { \"targets\": [4], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                        { \"targets\": [5], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                        { \"targets\": [6], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                    ],\r\n                    scrollY: '47vh',\r\n                    scrollCollapse: true,\r\n                    \"paging\": true,           // Enable pagination\r\n                    \"pageLength\": 50, \r\n                    \"lengthChange\": true,\r\n                    \"lengthMenu\": [50, 100, 250, 500], // Page length options \r\n                    //dom: '<\"toolbar\">frtlip',\r\n                    dom: '<\"row\"<\"col-sm-12 col-md-12\"<\"toolbar\">>><\"row\"<\"col-sm-12 col-md-6\"f>>' +\r\n                    '<\"row\"<\"col-sm-12\"tr>>' +\r\n                    '<\"row\"<\"col-sm-4 col-md-4\"l><\"col-sm-4 col-md-4\"i><\"col-sm-4 col-md-4\"p>>',\r\n                    initComplete: function( settings ) {\r\n                        var table = \$('#categories_table').DataTable();\r\n                        table.row(':eq(0)', { page: 'current' }).select();\r\n                        \r\n                         var stores_option = \"\";\r\n                         for(var i=0;i<stores.length;i++){\r\n                             stores_option+='<option value='+stores[i].id+' title=\"'+stores[i].name+'\">'+stores[i].name+'</option>';\r\n                         }\r\n                        \r\n                        \$(\"div.toolbar\").html('<h3>&nbsp;</h3><div id=\"tab_toolbar\" class=\"btn-group\" role=\"group\" aria-label=\"\">\\n\\\r\n                            <button onclick=\"addCategory_()\" type=\"button\" class=\"btn btn-primary  \"><i class=\"glyphicon glyphicon-plus\"></i>&nbsp;Add Sub-Category</button>\\n\\\r\n                            </div>\\n\\\r\n                            <div style=\"display:none\" id=\"tab_toolbar1\" class=\"btn-group\" role=\"group\" aria-label=\"\"><div class=\"btn-group tab_toolbar\" role=\"group\" aria-label=\"\">\\n\\\r\n                                <select id=\"store_list\" class=\"selectpicker\" onchange=\"store_changed()\">\\n\\\r\n                                    '+stores_option+'\\n\\\r\n                                </select>\\n\\\r\n                            </div>\\n\\\r\n                        </div>\\n\\\r\n                        ');\r\n                                    \r\n                        \$('.selectpicker').selectpicker();\r\n    \r\n                        if(table.rows().count()==0)\r\n                            \$(\"#tab_toolbar button.blueB\").addClass(\"disabled\");\r\n                        \r\n                        /*\r\n                        \$('[data-toggle=confirmation]').confirmation({\r\n                            rootSelector: '[data-toggle=confirmation]',\r\n                            placement: 'right',\r\n                            onConfirm: function() {\r\n                                if(disabled_action==0){\r\n\r\n                                    var dt = \$('#categories_table').DataTable();\r\n                                    var id = dt.row('.selected', 0).data();\r\n\r\n                                    if(\$(\"#tab_toolbar button.blueB\").hasClass(\"disabled\")==false){\r\n                                        \$(\".sk-circle-layer\").show();\r\n                                        \$.getJSON(\"?r=categories&f=delete_category&p0=\"+parseInt(id[0].split('-')[1]) , function (data) {\r\n                                            if(!data.status){\r\n                                                \$(\".sk-circle-layer\").hide();\r\n                                                swal(\"Unable to delete!\", \"Please contact system administrator\", \"warning\");\r\n                                            }else{\r\n                                                dt.row('.selected').remove().draw( false );\r\n                                                \$(\"#tab_toolbar button.blueB\").addClass(\"disabled\");\r\n                                                \$(\".sk-circle-layer\").hide();\r\n                                                swal(\"\", \"Category has been deleted.\", \"success\");\r\n\r\n                                                var table_parent = \$('#parent_categories_table').DataTable();\r\n                                                var id_parent = table_parent.row('.selected', 0).data();\r\n                                                table_parent.ajax.url('?r=categories&f=getAllParentCategories').load(function () {\r\n                                                    table_parent.row('.' + id_parent[0], {page: 'current'}).select();\r\n                                                },false);\r\n\r\n                                            }\r\n\r\n                                        }).done(function () {\r\n\r\n                                        });\r\n                                    }\r\n                                }else{\r\n                                     swal(\"Function Disabled\");\r\n                                }\r\n                            },\r\n                            onCancel: function() {\r\n                                \r\n                            },\r\n                            // other options\r\n                        });*/\r\n                        \r\n                        \$(\".sk-circle-layer\").hide();\r\n                        \r\n                        //var dt = \$('#parent_categories_table').DataTable();\r\n                        //var sdata = dt.row('.selected', 0).data();\r\n                        //update_categories(parseInt(sdata[0].split('-')[1]));\r\n                        \r\n                        \r\n                      \r\n                    },\r\n                    fnDrawCallback: updateRows,\r\n                    fnRowCallback: function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {\r\n                        \$(nRow).addClass(aData[0]);\r\n                    },\r\n                });\r\n                \r\n                \$('#categories_table').on( 'page.dt', function () {\r\n                    \$('#categories_table .selected').removeClass(\"selected\");\r\n                    \$(\"#tab_toolbar button.blueB\").addClass(\"disabled\");\r\n                });\r\n                \r\n                \$('#categories_table').DataTable().columns().every( function () {\r\n                    var that = this;\r\n                    \$( 'input', this.footer() ).on( 'keyup change', function () {\r\n                        \$('#categories_table .selected').removeClass(\"selected\");\r\n                        \$(\"#tab_toolbar button.blueB\").addClass(\"disabled\");\r\n                        if ( that.search() !== this.value ) {\r\n                            that.search( this.value ).draw();\r\n                        }\r\n                    } );\r\n                } );\r\n                \r\n                \$('#categories_table').DataTable().on( 'select', function ( e, dt, type, indexes ) {\r\n                    if (type === 'row') {\r\n                        \$('#contacts').popover('hide');\r\n                        \$(\"#tab_toolbar button.blueB\").removeClass(\"disabled\");\r\n                    }\r\n                } );\r\n                \r\n                \$('#categories_table').DataTable().on( 'deselect', function ( e, dt, type, indexes ) {\r\n                    if (type === 'row') {\r\n                        \$(\"#tab_toolbar button.blueB\").addClass(\"disabled\");\r\n                    }\r\n                });\r\n                \r\n                \$(\"#categories_table\").on(\"mousedown\", \"tr\", function(event) {\r\n                    \$('#categories_table .selected').removeClass(\"selected\");\r\n                    var dt = \$('#categories_table').DataTable();\r\n                    var index = dt.row(this).index();\r\n                    dt.row(index).select(index);\r\n                    \r\n                    \r\n                });\r\n                \r\n                \$('#parent_categories_table').on( 'page.dt', function () {\r\n                    \$('#parent_categories_table .selected').removeClass(\"selected\");\r\n                    \$(\"#tab_toolbar1 button.blueB\").addClass(\"disabled\");\r\n                });\r\n                \r\n                \$('#parent_categories_table').DataTable().columns().every( function () {\r\n                    var that = this;\r\n                    \$( 'input', this.footer() ).on( 'keyup change', function () {\r\n                        \$('#parent_categories_table .selected').removeClass(\"selected\");\r\n                        \$(\"#tab_toolbar1 button.blueB\").addClass(\"disabled\");\r\n                        if ( that.search() !== this.value ) {\r\n                            that.search( this.value ).draw();\r\n                        }\r\n                    } );\r\n                } );\r\n                \r\n                \r\n                \$('#parent_categories_table').DataTable().on( 'select', function ( e, dt, type, indexes ) {\r\n                    if (type === 'row') {\r\n                        \$('#contacts').popover('hide');\r\n                        \$(\"#tab_toolbar1 button.blueB\").removeClass(\"disabled\");\r\n                    }\r\n                } );\r\n                \r\n                \$('#parent_categories_table').DataTable().on( 'deselect', function ( e, dt, type, indexes ) {\r\n                    if (type === 'row') {\r\n                        \$(\"#tab_toolbar1 button.blueB\").addClass(\"disabled\");\r\n                    }\r\n                });\r\n              \r\n                \$(\"#parent_categories_table\").on(\"mousedown\", \"tr\", function(event) {\r\n                    \$('#parent_categories_table .selected').removeClass(\"selected\");\r\n                    var dt = \$('#parent_categories_table').DataTable();\r\n                    var index = dt.row(this).index();\r\n                    dt.row(index).select(index);\r\n                    \r\n                    var dt = \$('#parent_categories_table').DataTable();\r\n                    var sdata = dt.row('.selected', 0).data();\r\n                    update_categories(parseInt(sdata[0].split('-')[1]));\r\n                });\r\n            }\r\n           \r\n           function store_changed(){\r\n                \$(\".sk-circle-layer\").show();\r\n                //current_store_id = \$(\"#store_list\").val();\r\n                var dt = \$('#parent_categories_table').DataTable();\r\n                var sdata = dt.row('.selected', 0).data();\r\n                update_categories(parseInt(sdata[0].split('-')[1]));\r\n           }\r\n           \r\n            \$(document).ready(function () {\r\n                \$.getJSON(\"?r=store&f=getStores\", function (data) {\r\n                    \$.each(data, function (key, val) {\r\n                        //if(current_store_id==null){\r\n                            //current_store_id = val.id;\r\n                        //}\r\n                        stores.push({id:val.id,location:val.location,name:val.name});\r\n                    });\r\n                }).done(function () {\r\n                    \$.getJSON(\"?r=settings_info&f=getSettingsInfo\", function (data) {\r\n                         default_currency_symbol = data.default_currency_symbol;\r\n                    }).done(function () {\r\n                        init();\r\n                    });\r\n                }); \r\n            });\r\n            \r\n            function addCategory_(){\r\n                if(disabled_action==0){\r\n                    \r\n                    addCategory('add',[]);\r\n                    \r\n               }else{\r\n                    swal(\"Function Disabled\");\r\n               }\r\n                \r\n            }\r\n            \r\n            function addParentCategory_(){\r\n                if(disabled_action==0){\r\n                    \r\n                        addParentCategory('add');\r\n                    \r\n                }else{\r\n                    swal(\"Function Disabled\");\r\n                }\r\n                \r\n            }\r\n            \r\n            function editCategory_(){\r\n                if(disabled_action==0){\r\n                   \r\n                    if(\$(\"#tab_toolbar button.blueB\").hasClass(\"disabled\")==false){\r\n                        var dt = \$('#categories_table').DataTable();\r\n                        var sdata = dt.row('.selected', 0).data();\r\n                        editCategory(sdata[0],0);\r\n                    }\r\n                   \r\n                }else{\r\n                    swal(\"Function Disabled\");\r\n                }\r\n                \r\n            }\r\n            \r\n            function editParentCategory_(){\r\n                if(disabled_action==0){\r\n                       \r\n                    if(\$(\"#tab_toolbar1 button.blueB\").hasClass(\"disabled\")==false){\r\n                        var dt = \$('#parent_categories_table').DataTable();\r\n                        var sdata = dt.row('.selected', 0).data();\r\n                        editParentCategory(sdata[0],0);\r\n                    }\r\n                    \r\n                }else{\r\n                    swal(\"Function Disabled\");\r\n                }\r\n            }\r\n            \r\n            \r\n            \r\n            function update_categories(id_parent_category){\r\n                var dt = \$('#categories_table').DataTable();\r\n                var table = \$('#categories_table').DataTable();\r\n                        \r\n                table.ajax.url('?r=categories&f=getAllCategoriesByParent&p0='+id_parent_category+'&p1='+current_store_id).load(function () {\r\n                    \r\n                    if(table.rows().count()>0){\r\n                        var sdata_category = dt.row(0).data()[0];\r\n                        table.row('.' + sdata_category, {page: 'current'}).select();\r\n                    }\r\n                    \r\n                    \$(\".sk-circle-layer\").hide();\r\n                },false);\r\n            }\r\n            \r\n            function moveto(current_subcategory){\r\n                var to = \$(\"#subcat_id_to_move\").val();\r\n                var _data=[];\r\n                \$.getJSON(\"?r=categories&f=move_subcategory_action&p0=\"+current_subcategory+\"&p1=\"+to, function (data) {\r\n                    _data=data;\r\n                }).done(function () {\r\n                    \$('#move_subcate').modal('hide');\r\n                    \r\n                    var table = \$('#categories_table').DataTable();\r\n                    var current_selected_parent = 1;\r\n                    var table_parent = \$('#parent_categories_table').DataTable();\r\n                    if(table_parent.row('.selected', 0).length>0){\r\n                        var id = table_parent.row('.selected', 0).data();\r\n                        current_selected_parent = parseInt(id[0].split(\"-\")[1]);\r\n                    }\r\n              \r\n\r\n                    table.ajax.url('?r=categories&f=getAllCategoriesByParent&p0='+current_selected_parent+'&p1='+current_store_id).load(function () {\r\n                        table.row('.' + pad_cat(current_subcategory), {page: 'current'}).select();\r\n                    },false);\r\n                            \r\n                });\r\n            }\r\n            \r\n            function move_subcategory_to(subcategory_id){\r\n                \$(\".sk-circle\").center();\r\n                \$(\".sk-circle-layer\").show();\r\n                var _data=[];\r\n                \$.getJSON(\"?r=categories&f=move_subcategory_to&p0=\"+subcategory_id, function (data) {\r\n                    _data=data;\r\n                }).done(function () {\r\n                    \$(\".sk-circle-layer\").hide();\r\n                    if(_data.available_count>0){\r\n                        \r\n                        var op=\"\";\r\n                        for(var i=0;i<_data.all_sub_categories.length;i++){\r\n                            op+=\"<option value='\"+_data.all_sub_categories[i].id+\"'>\"+_data.all_sub_categories[i].description+\"</option>\";\r\n                        }\r\n                        \r\n                        var content =\r\n                        '<div class=\"modal\" data-keyboard=\"false\" data-backdrop=\"static\" id=\"move_subcate\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\" >\\n\\\r\n                            <div class=\"modal-dialog\" role=\"document\">\\n\\\r\n                                <div class=\"modal-content\">\\n\\\r\n                                    <div class=\"modal-header\"> \\n\\\r\n                                        <h3 class=\"modal-title\">Transfer '+_data.available_count+' items from selected subcategory to another.<i style=\"font-size:30px;float:right;cursor:pointer\" class=\"glyphicon glyphicon-remove\" onclick=\"close_move_subcate()\"></i></h3>\\n\\\r\n                                    </div>\\n\\\r\n                                    <div class=\"modal-body\">\\n\\\r\n                                        <div class=\"row\">\\n\\\r\n                                            <div class=\"col-lg-6 col-md-6\" >\\n\\\r\n                                                <select  data-live-search=\"true\" id=\"subcat_id_to_move\" class=\"selectpicker\">\\n\\\r\n                                                    '+op+'\\n\\\r\n                                                </select>\\n\\\r\n                                            </div>\\n\\\r\n                                            <div class=\"col-lg-6 col-md-6\" >\\n\\\r\n                                                \\n\\\r\n                                            </div>\\n\\\r\n                                        </div>\\n\\\r\n                                    </div>\\n\\\r\n                                    <div class=\"modal-footer\">\\n\\\r\n                                            <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Cancel</button>\\n\\\r\n                                            <button id=\"action_btn\" type=\"button\" class=\"btn btn-primary\" onclick=\"moveto('+subcategory_id+')\">Move</button>\\n\\\r\n                                    </div>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                        </div>';\r\n                        \$('#move_subcate').modal('hide');\r\n                        \$(\"body\").append(content);\r\n\r\n                        \$(\"#move_subcate\").centerWH();\r\n\r\n                        \$('#move_subcate').on('show.bs.modal', function (e) {\r\n                            \$(\"#subcat_id_to_move\").selectpicker();\r\n                        });\r\n\r\n                        \$('#move_subcate').on('hide.bs.modal', function (e) {\r\n                            \$('#move_subcate').remove();\r\n                        });\r\n                        \$('#move_subcate').modal('show');\r\n                    }else{\r\n                        \$.alert({\r\n                            title: 'Alert!',\r\n                            content: 'There are no items available in this subcategory',\r\n                        });\r\n                    }\r\n                }); \r\n            }\r\n            \r\n            function delete_category(id){\r\n                \$.confirm({\r\n                    title: 'Delete Sub-Category!',\r\n                    content: 'Are you sure?',\r\n                     animation: 'zoom',\r\n                    closeAnimation: 'zoom',\r\n                    animateFromElement:false,\r\n                    buttons: {\r\n                        DELETE: {\r\n                            btnClass: 'btn-danger',\r\n                            action: function(){\r\n                                \$(\".sk-circle-layer\").show();\r\n                                \$.getJSON(\"?r=categories&f=delete_category&p0=\"+parseInt(id) , function (data) {\r\n                                    if(!data.status){\r\n                                        \$.alert({\r\n                                            title: '<b class=\"text-danger\">Unable to delete!</b>',\r\n                                            content: 'Cannot delete a subcategory that contains items',\r\n                                        });\r\n                                        //swal(\"Unable to delete!\", \"Please contact system administrator\", \"warning\");\r\n                                    }else{\r\n                                        //dt.row('.selected').remove().draw( false );\r\n                                        //\$(\"#tab_toolbar button.blueB\").addClass(\"disabled\");\r\n                                        //\$(\".sk-circle-layer\").hide();\r\n                                        //swal(\"\", \"Category has been deleted.\", \"success\");\r\n\r\n                                        /*var table_parent = \$('#parent_categories_table').DataTable();\r\n                                        var id_parent = table_parent.row('.selected', 0).data();\r\n                                        table_parent.ajax.url('?r=categories&f=getAllParentCategories').load(function () {\r\n                                            table_parent.row('.' + id_parent[0], {page: 'current'}).select();\r\n                                        },false);*/\r\n            \r\n                                        var dt = \$('#parent_categories_table').DataTable();\r\n                                        var sdata = dt.row('.selected', 0).data();\r\n                                        update_categories(parseInt(sdata[0].split('-')[1]));\r\n\r\n                                    }\r\n                                    \$(\".sk-circle-layer\").hide();\r\n                                }).done(function () {\r\n\r\n                                });\r\n                            }\r\n                        },\r\n                        CANCEL: {\r\n                            btnClass: 'btn-default any-other-class', // multiple classes.\r\n                            action: function(){\r\n\r\n                            }\r\n                        },\r\n                    }\r\n                });\r\n                \r\n            }\r\n            \r\n            function updateRows(){\r\n                var table = \$('#categories_table').DataTable();\r\n                var p = table.rows({ page: 'current' }).nodes();\r\n                for (var k = 0; k < p.length; k++){\r\n                    var index = table.row(p[k]).index();\r\n                    table.cell(index, 4).data('<button onclick=\"show_items_by_subcategory(\\''+parseInt(table.cell(index, 0).data().split(\"-\")[1])+'\\')\" type=\"button\" class=\"btn btn-xs btn-info show_items\">Show Items</button>');\r\n                    \r\n                    if(disabled_action==0){\r\n                        //table.cell(index, 5).data('<button onclick=\"addItem(\\'categories\\')\" type=\"button\" class=\"btn btn-xs btn-default show_items\">Create Item</button>');\r\n                    }else{\r\n                        //table.cell(index, 5).data('<button onclick=\"swal(\\'Function Disabled\\')\" type=\"button\" class=\"btn btn-xs btn-default show_items\">Create Item</button>');\r\n                    }\r\n                    \r\n                    table.cell(index, 5).data('<button onclick=\"move_subcategory_to(\\''+parseInt(table.cell(index, 0).data().split(\"-\")[1])+'\\')\" type=\"button\" class=\"btn btn-xs btn-default show_items\">Move To</button>');\r\n                    \r\n                    table.cell(index, 6).data('&nbsp;<i style=\"cursor:pointer\" onclick=\"addItem(\\'categories\\')\" title=\"Create Item\" class=\"glyphicon glyphicon-plus\"></i>&nbsp;&nbsp;<i onclick=\"editCategory_new('+parseInt(table.cell(index, 0).data().split(\"-\")[1])+')\" title=\"Edit\" class=\"glyphicon glyphicon-edit edit_icon\"></i>&nbsp;&nbsp;<i onclick=\"delete_category('+parseInt(table.cell(index, 0).data().split(\"-\")[1])+')\" title=\"Delete\" class=\"glyphicon glyphicon-trash trash_icon red\"\"></i>');\r\n\r\n                }\r\n            }\r\n            \r\n            function show_items_by_subcategory(id){\r\n                \r\n               var content =\r\n                '<div class=\"modal\" data-keyboard=\"false\" data-backdrop=\"static\" id=\"showItemsBySubCat\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\" >\\n\\\r\n                    <div class=\"modal-dialog\" role=\"document\">\\n\\\r\n                        <div class=\"modal-content\">\\n\\\r\n                            <div class=\"modal-header\"> \\n\\\r\n                                <h3 class=\"modal-title\">Items By Sub-Category<i style=\"font-size:30px;float:right;cursor:pointer\" class=\"glyphicon glyphicon-remove\" onclick=\"close_ibsub_modal()\"></i></h3>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"modal-body\">\\n\\\r\n                                <table style=\"width:100%\" id=\"items_by_cat_table_details\" class=\"table table-striped table-bordered\" cellspacing=\"0\">\\n\\\r\n                                    <thead>\\n\\\r\n                                        <tr>\\n\\\r\n                                            <th style=\"width: 40px !important;\">Ref.</th>\\n\\\r\n                                            <th>Name</th>\\n\\\r\n                                            <th style=\"width: 80px !important;\">Barcode</th>\\n\\\r\n                                            <th style=\"width: 60px !important;\">Cost</th>\\n\\\r\n                                            <th style=\"width: 60px !important;\">Price</th>\\n\\\r\n                                            <th style=\"width: 40px !important;\">Dis. %</th>\\n\\\r\n                                            <th style=\"width: 20px !important;\">Qty</th>\\n\\\r\n                                            <th style=\"width: 40px !important;\">Size</th>\\n\\\r\n                                            <th style=\"width: 40px !important;\">Color</th>\\n\\\r\n                                            <th style=\"width: 270px !important;\">&nbsp;</th>\\n\\\r\n                                        </tr>\\n\\\r\n                                    </thead>\\n\\\r\n                                    <tfoot>\\n\\\r\n                                        <tr>\\n\\\r\n                                            <th>Ref.</th>\\n\\\r\n                                            <th>Name</th>\\n\\\r\n                                            <th>Barcode</th>\\n\\\r\n                                            <th>Cost</th>\\n\\\r\n                                            <th>Price</th>\\n\\\r\n                                            <th>Discount</th>\\n\\\r\n                                            <th>Qty</th>\\n\\\r\n                                            <th>Size</th>\\n\\\r\n                                            <th>Color</th>\\n\\\r\n                                            <th>&nbsp;</th>\\n\\\r\n                                        </tr>\\n\\\r\n                                    </tfoot>\\n\\\r\n                                    <tbody></tbody>\\n\\\r\n                                </table>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"modal-footer\">\\n\\\r\n                            </div>\\n\\\r\n                        </div>\\n\\\r\n                    </div>\\n\\\r\n                </div>';\r\n                \$(\"#showItemsBySubCat\").remove();\r\n                \$(\"body\").append(content);\r\n\r\n                \$(\"#showItemsBySubCat\").centerWH();\r\n\r\n                \$('#showItemsBySubCat').on('show.bs.modal', function (e) {\r\n                    var items_by_cat_table_details = null;\r\n                    var search_fields = [0,1,2,3,4,5,6,7,8];\r\n                    var index = 0;\r\n                    \$('#items_by_cat_table_details tfoot th').each( function () {\r\n                        if(jQuery.inArray(index, search_fields) !== -1){\r\n                            var title = \$(this).text();\r\n                            \$(this).html( '<div class=\"inner-addon left-addon\"><input style=\"width: 100% !important;\"  class=\"form-control input_sm_search\" type=\"text\" placeholder=\" '+title+'\" /></div>' );\r\n                            index++;\r\n                        }\r\n                    });\r\n                \r\n                   items_by_cat_table_details = \$('#items_by_cat_table_details').DataTable({\r\n                        ajax: \"?r=items&f=get_all_items_of_sub_category&p0=\"+id+\"&p1=\"+current_store_id,\r\n                        orderCellsTop: true,\r\n                        select: true,\r\n                        iDisplayLength: 100,\r\n                        aoColumnDefs: [\r\n                            { \"targets\": [0], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [1], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [2], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [3], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [4], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [5], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [6], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [7], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [8], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                            { \"targets\": [9], \"searchable\": true, \"orderable\": false, \"visible\": true },\r\n                        ],\r\n                        scrollY: '47vh',\r\n                        scrollCollapse: true,\r\n                        \"paging\": true,           // Enable pagination\r\n                        \"pageLength\": 50, \r\n                        \"lengthChange\": true,\r\n                        \"lengthMenu\": [50, 100, 250, 500], // Page length options \r\n                        //dom: '<\"toolbar\">frtlip',\r\n                        dom: '<\"row\"<\"col-sm-12 col-md-12\"<\"toolbar\">>><\"row\"<\"col-sm-12 col-md-6\"f>>' +\r\n                        '<\"row\"<\"col-sm-12\"tr>>' +\r\n                        '<\"row\"<\"col-sm-4 col-md-4\"l><\"col-sm-4 col-md-4\"i><\"col-sm-4 col-md-4\"p>>',\r\n                        fnDrawCallback: updateRowsDetails,\r\n                        fnRowCallback: function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {\r\n                            \$(nRow).addClass(aData[0]);\r\n                        },\r\n                        initComplete: function(settings, json) {\r\n                            items_by_cat_table_details.cell( ':eq(0)' ).focus();\r\n                            \r\n                            \$(\"div.toolbarcat\").html('\\n\\\r\n                                <div class=\"row\" id=\"tab_toolbar\">\\n\\\r\n                                    <div class=\"col-lg-12 col-md-12 col-sm-12\" >\\n\\\r\n                                        <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%\">\\n\\\r\n                                            <div class=\"btn-group\" id=\"buttons_cat\" style=\"float:right\"></div>\\n\\\r\n                                        </div>\\n\\\r\n                                    </div>\\n\\\r\n                                </div>\\n\\\r\n                            ');\r\n                            \r\n                            var buttons = new \$.fn.dataTable.Buttons(items_by_cat_table_details, {\r\n                            buttons: [\r\n                              {\r\n                                    extend: 'excel',\r\n                                    text: 'Export excel',\r\n                                    className: 'exportExcel',\r\n                                    filename: 'Items',\r\n                                    customize: _customizeExcelOptions,\r\n                                    exportOptions: {\r\n                                        modifier: {\r\n                                            page: 'all'\r\n                                        },\r\n                                        columns: [ 0,1,2,3,4,5,6,7,8 ]\r\n                                        //format: {\r\n                                            //body: function ( data, row, column, node ) {\r\n                                                // Strip \$ from salary column to make it numeric\r\n                                                ///return column === 6 ? data.replace( /[L.L.,]/g, '' ) : data;\r\n                                            //}\r\n                                        //}\r\n                                    }\r\n                              }\r\n                            ]\r\n                            \r\n                       }).container().appendTo(\$('#buttons_cat'));\r\n                       \r\n                       function _customizeExcelOptions(xlsx) {\r\n                           var sheet = xlsx.xl.worksheets['sheet1.xml'];\r\n                            var clR = \$('row', sheet);\r\n                            //var r1 = Addrow(clR.length+2, [{key:'A',value: \"Total Credit Notes\"},{key:'B',value: total}]);\r\n                            //sheet.childNodes[0].childNodes[1].innerHTML = sheet.childNodes[0].childNodes[1].innerHTML + r1;\r\n                            \r\n                            //\$('row c[r^=\"A'+(clR.length+2)+'\"]', sheet).attr('s', '48');\r\n                            \r\n                            function Addrow(index, data) {\r\n                                var msg = '<row r=\"' + index + '\">'\r\n                                    for (var i = 0; i < data.length; i++) {\r\n                                        var key = data[i].key;\r\n                                        var value = data[i].value;\r\n                                        msg += '<c t=\"inlineStr\" r=\"' + key + index + '\">';\r\n                                        msg += '<is>';\r\n                                        msg += '<t>' + value + '</t>';\r\n                                        msg += '</is>';\r\n                                        msg += '</c>';\r\n                                    }\r\n                                    msg += '</row>';\r\n                                    return msg;\r\n                                }\r\n                            }\r\n                        \r\n                        \r\n                        \r\n                        }\r\n                    });\r\n                    \r\n                    \$('#items_by_cat_table_details tbody').on( 'click', 'tr', function () {\r\n                        if (\$(this).hasClass('selected') ) {\r\n                            return false;\r\n                        }else {\r\n                            //items_by_cat_table_details.\$('tr.selected').removeClass('selected');\r\n                            //\$(this).addClass('selected');\r\n                        }\r\n                    } );\r\n                    \r\n                    \$('#items_by_cat_table_details').on('key-focus.dt', function(e, datatable, cell){\r\n                        \$(items_by_cat_table_details.row(cell.index().row).node()).addClass('selected');\r\n                    });\r\n\r\n                    \$('#items_by_cat_table_details').on('key-blur.dt', function(e, datatable, cell){\r\n                        \$(items_by_cat_table_details.row(cell.index().row).node()).removeClass('selected');\r\n                    });\r\n\r\n                    \$('#items_by_cat_table_details').on('key.dt', function(e, datatable, key, cell, originalEvent){\r\n                        if(key === 13){\r\n                            //alert(key);\r\n                        }\r\n                    }); \r\n                    \r\n                    \$('#items_by_cat_table_details').DataTable().columns().every( function () {\r\n                        var that = this;\r\n                        \$( 'input', this.footer() ).on( 'keyup change', function () {\r\n                            items_by_cat_table_details.keys.disable();\r\n                            if ( that.search() !== this.value ) {\r\n                                that.search( this.value ).draw();\r\n                            }\r\n                            items_by_cat_table_details.keys.enable();\r\n                        } );\r\n                    } );\r\n                });\r\n\r\n                \$('#showItemsBySubCat').on('hide.bs.modal', function (e) {\r\n                    \$('#showItemsBySubCat').remove();\r\n                });\r\n                \$('#showItemsBySubCat').modal('show');\r\n            }\r\n            \r\n            function BulkItem_(item_id){\r\n                \r\n                       \r\n                if(disabled_action==0){\r\n           \r\n                    BulkItem(parseInt(item_id));    \r\n                }else{\r\n                     swal(\"Function Disabled\");\r\n                }\r\n\r\n               \r\n            }\r\n            \r\n            function updateRowsDetails(){\r\n                var table = \$('#items_by_cat_table_details').DataTable();\r\n                var p = table.rows({ page: 'current' }).nodes();\r\n                var shortcuts = \"\";\r\n           \r\n                for (var k = 0; k < p.length; k++){\r\n                    var index = table.row(p[k]).index();\r\n                    shortcuts = \"\";\r\n                    \r\n                    if(multi_branches==1){\r\n                        shortcuts+=\"<i onclick='transfer_between_m_branches(0,0,\"+parseInt(table.cell(index, 0).data().split('-')[1])+\")' title='Transfer to branch' class='glyphicon glyphicon-transfer shortcut'></i>&nbsp;&nbsp;\";\r\n                    }\r\n                    \r\n                    \r\n                    if(mobile_shop==1){\r\n                        shortcuts+=\"<i onclick='create_unique_items_for_item(\"+parseInt(table.cell(index, 0).data().split('-')[1])+\", 0)' title='Item Codes' class='glyphicon glyphicon-equalizer shortcut'></i>\";\r\n                    }\r\n                    \r\n                    \r\n                    if(disabled_action==0){\r\n                        shortcuts+='<i onclick=\"duplicateItem_(\\''+table.cell(index, 0).data()+'\\')\" title=\"Duplicate\" class=\"glyphicon glyphicon-duplicate shortcut\"></i>';\r\n                    }\r\n                    \r\n                    shortcuts+='<i class=\"glyphicon glyphicon-barcode shortcut\" title=\"Print Barcode\" onclick=\"print_barcode_(\\''+parseInt(table.cell(index, 0).data().split('-')[1])+'\\',1)\"></i>';\r\n\r\n                    if(disabled_action==0){\r\n                        shortcuts+='<i class=\"glyphicon glyphicon-plus shortcut\" title=\"Add qty\" onclick=\"add_items_to_store(\\''+parseInt(table.cell(index, 0).data().split('-')[1])+'\\','+parseInt(\$(\"#store_list\").val())+',\\'from_categories\\')\"></i>';\r\n                        shortcuts+='<i style=\"'+ptype_hide+'\" class=\"glyphicon glyphicon-folder-open shortcut\" title=\"Group\" onclick=\"BulkItem_(\\''+parseInt(table.cell(index, 0).data().split('-')[1])+'\\')\"></i>';\r\n                    }\r\n\r\n                    shortcuts+='<i class=\"glyphicon glyphicon-align-center shortcut\" title=\"Stock Tracking\" onclick=\"_logs(\\''+parseInt(table.cell(index, 0).data().split('-')[1])+'\\')\"></i>';\r\n\r\n                    shortcuts+='<i class=\"glyphicon glyphicon-time shortcut\" title=\"Expiry Date\" onclick=\"setExpiryItemOfStore(\\''+parseInt(table.cell(index, 0).data().split('-')[1])+'\\',1,\\'from_categories\\')\"></i>';\r\n\r\n                    if(disabled_action==0){\r\n                        shortcuts+='<i class=\"glyphicon glyphicon-edit shortcut\" title=\"Edit\" onclick=\"editItem(\\''+table.cell(index, 0).data()+'\\',0)\"></i>';\r\n                        shortcuts+='<i class=\"glyphicon glyphicon-trash shortcut red\" title=\"Delete\" onclick=\"deleteItem(\\''+table.cell(index, 0).data().split('-')[1]+'\\',0)\"></i>';\r\n                    }\r\n\r\n                    \r\n                    \r\n                    table.cell(index, 9).data(shortcuts);\r\n                }\r\n            }\r\n            \r\n            function _logs(id){\r\n                setTimeout(function(){\r\n                    var dt = \$('#items_by_cat_table_details').DataTable();                \r\n                    var sdata_name = dt.row('.selected', 0).data();\r\n                    var item_name = sdata_name[1];\r\n\r\n                    //current_store_id = \$(\"#store_list\").val();\r\n                    logs(id,item_name);\r\n                },200);\r\n                \r\n            }\r\n            \r\n            function close_ibsub_modal(){\r\n                \$('#showItemsBySubCat').modal('toggle');\r\n            }\r\n            \r\n            function close_move_subcate(){\r\n                \$('#move_subcate').modal('toggle');\r\n            }\r\n            \r\n            \r\n            function duplicateItem_(id){\r\n                editItem(id,1);\r\n            }\r\n            \t\r\n        </script>\r\n    </head>\r\n    <body>\r\n        \r\n        <!-- Navbar fixed top -->\r\n        ";
include "application/mvc/views/topMenu.php";
echo "        <div class=\"container\">\r\n            <div class=\"panel panel-default\">\r\n                <div class=\"panel-body\" style=\"margin-top: 50px;\">\r\n                    <div class=\"row\"  >\r\n                        \r\n                        \r\n                        <div class=\"col-lg-4 col-md-4\" >           \r\n                            <table id=\"parent_categories_table\" class=\"table table-striped table-bordered\" cellspacing=\"0\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th style=\"width: 40px !important;\">Ref.</th>\r\n                                        <th>Name</th>\r\n                                        <th style=\"width: 95px !important;\">Sub-Categories</th>\r\n                                        <th style=\"width: 70px !important;\">Action</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tfoot>\r\n                                    <tr>\r\n                                        <th>Ref.</th>\r\n                                        <th>Name</th>\r\n                                        <th>Sub-Categories</th>\r\n                                        <th>&nbsp;</th>\r\n                                    </tr>\r\n                                </tfoot>\r\n                                <tbody></tbody>\r\n                            </table>\r\n                        </div>\r\n                        \r\n                        <div class=\"col-lg-8 col-md-8\" >           \r\n                            <table id=\"categories_table\" class=\"table table-striped table-bordered\" cellspacing=\"0\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th style=\"width: 60px !important;\">Ref.</th>\r\n                                        <th>Name</th>\r\n                                        <th style=\"width: 50px !important;\">Items</th>\r\n                                        <th style=\"width: 100px !important;\">Total Stock Qty</th>\r\n                                        <th style=\"width: 70px !important;\"></th>\r\n                                        <th style=\"width: 50px !important;\"></th>\r\n                                        <th style=\"width: 80px !important;\"></th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tfoot>\r\n                                    <tr>\r\n                                        <th>Ref.</th>\r\n                                        <th>Name</th>\r\n                                        <th>Items</th>\r\n                                        <th>Total Stock Qty</th>\r\n                                        <th></th>\r\n                                        <th></th>\r\n                                         <th></th>\r\n                                    </tr>\r\n                                </tfoot>\r\n                                <tbody></tbody>\r\n                            </table>\r\n                        </div>\r\n                        \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            \r\n        </div>\r\n        \r\n        \r\n        \r\n        <div class=\"sk-circle-layer\">\r\n            <div class=\"sk-circle\">\r\n                <div class=\"sk-circle1 sk-child\"></div>\r\n                <div class=\"sk-circle2 sk-child\"></div>\r\n                <div class=\"sk-circle3 sk-child\"></div>\r\n                <div class=\"sk-circle4 sk-child\"></div>\r\n                <div class=\"sk-circle5 sk-child\"></div>\r\n                <div class=\"sk-circle6 sk-child\"></div>\r\n                <div class=\"sk-circle7 sk-child\"></div>\r\n                <div class=\"sk-circle8 sk-child\"></div>\r\n                <div class=\"sk-circle9 sk-child\"></div>\r\n                <div class=\"sk-circle10 sk-child\"></div>\r\n                <div class=\"sk-circle11 sk-child\"></div>\r\n                <div class=\"sk-circle12 sk-child\"></div>\r\n            </div>\r\n        </div>\r\n    </body>\r\n</html>\r\n\r\n";

?>