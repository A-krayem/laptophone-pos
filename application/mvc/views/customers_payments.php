<?php
/*
 * @ https://EasyToYou.eu - IonCube v11 Decoder Online
 * @ PHP 5.6
 * @ Decoder version: 1.0.4
 * @ Release: 02/06/2020
 *
 * @ ZendGuard Decoder PHP 5.6
 */

// Decoded file for php version 53.
echo "<!DOCTYPE html>\n<!--\nTo change this license header, choose License Headers in Project Properties.\nTo change this template file, choose Tools | Templates\nand open the template in the editor.\n-->\n<html>\n    <head>\n        <title>";
echo $_SESSION["page_title"];
echo " Customer Payments</title>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <link rel=\"icon\" type=\"image/png\" href=\"resources/favicon.png\">\n\n        <script src=\"libraries/jquery-3.1.1.min.js\" type=\"text/javascript\"></script>\n\n        <script src=\"libraries/bootstrap-3.3.7-dist/js/bootstrap.min.js\" type=\"text/javascript\"></script>\n        <link href=\"libraries/bootstrap-3.3.7-dist/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n        \n        \n        <script src=\"application/mvc/views/custom_libraries/javascripts/global.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\n        \n        \n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/js/jquery.dataTables.min.js\" type=\"text/javascript\"></script>\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/js/dataTables.bootstrap.min.js\" type=\"text/javascript\"></script>\n        <link href=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/css/dataTables.bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/extensions/Select/js/dataTables.select.min.js\" type=\"text/javascript\"></script>\n\n        <script src=\"libraries/bootstrap-plugins/bootstrap-select-master/bootstrap-select-master/dist/js/bootstrap-select.min.js\" type=\"text/javascript\"></script>\n        <link href=\"libraries/bootstrap-plugins/bootstrap-select-master/bootstrap-select-master/dist/css/bootstrap-select.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n        \n        <link href=\"libraries/bootstrap-plugins/bootstrap-sweetalert-master/dist/sweetalert.css\" rel=\"stylesheet\" type=\"text/css\"/>\n        <script src=\"libraries/bootstrap-plugins/bootstrap-sweetalert-master/dist/sweetalert.min.js\" type=\"text/javascript\"></script>\n        \n        \n        <link href=\"application/mvc/views/custom_libraries/svgs/font/style.css?rnd=";
echo self::generateRandomStringComplex();
echo "\" rel=\"stylesheet\" type=\"text/css\"/>\n        <link href=\"application/mvc/views/custom_libraries/css/global.css?rnd=";
echo self::generateRandomStringComplex();
echo "\" rel=\"stylesheet\" type=\"text/css\"/>\n        <script src=\"libraries/numeric.js\" type=\"text/javascript\"></script>\n        \n                <script src=\"libraries/cleave.js-master/dist/cleave.min.js\" type=\"text/javascript\"></script>\n                \n        <style type=\"text/css\">\n            \n            html,body {\n                padding-top: 30px !important;\n            }\n\n            .container,.panel {\n                height:100%;\n                width: 100%;\n                padding: 0px !important;\n                margin: 0px !important;\n            }\n            \n            .table>tfoot>tr>th{\n                font-size: 12px !important;\n                background-color: #F3F3F3;\n                padding: 2px;\n                border: none !important;\n            }\n            \n            .dataTables_filter { display: none; }\n            \n            .selected{\n                background-color: #337ab7 !important;\n                color: #ffffff !important;\n            }\n            \n            .search_filter{\n                width: 100% !important;\n                color: #000;\n            }\n            \n            \n            ::-webkit-input-placeholder { /* Chrome/Opera/Safari */\n                color: #337ab7;\n                opacity: 0.9;\n            }\n            ::-moz-placeholder { /* Firefox 19+ */\n                color: #337ab7;\n                opacity: 0.9;\n            }\n            :-ms-input-placeholder { /* IE 10+ */\n                color: #337ab7;\n                opacity: 0.9;\n            }\n            :-moz-placeholder { /* Firefox 18- */\n                color: #337ab7;\n                opacity: 0.9;\n            }\n            \n            /* enable absolute positioning */\n            .inner-addon { \n                position: relative; \n            }\n\n            /* style icon */\n            .inner-addon .glyphicon {\n              position: absolute;\n              padding: 6px;\n              pointer-events: none;\n            }\n\n            /* align icon */\n            .left-addon .glyphicon  { left:  0px;}\n            .right-addon .glyphicon { right: 0px;}\n\n            /* add padding  */\n            .left-addon input  { padding-left:  20px; }\n            .right-addon input { padding-right: 30px; }\n            \n            .phone-input{\n                    margin-bottom:8px;\n            }\n            \n            .confirmation {\n                width: 160px;\n            }\n            \n            .list-group-item{\n                border: none !important;\n            }\n            \n            div.toolbar h3{\n                margin-top: 0px !important;\n            }\n            \n            .dataTable>tfoot>tr>th{\n                /* width: 50px !important; */\n            }\n            \n            .item_icon{\n                font-size: 18px;\n            }\n            .addon_item_icon input{\n                padding-left: 30px !important;\n            }\n            \n            .opened{\n                color:red;\n                font-weight: bold\n            }\n            \n            .btn-xs{\n                font-size: 14px !important;\n                padding-top: 0px !important;\n                width: 100%\n            }\n            \n            #cutomer_paymets_table tr:hover {\n                background-color: rgb(51, 122, 183) !important;\n                color: #fff !important;\n            }\n            \n            .payInput{\n                width: 70px;\n                height: 28px;\n                text-align: center;\n            }\n        </style>\n        <script type=\"text/javascript\">\n            var cutomer_paymets_table = null;\n            var current_customer_id = 0;\n            var current_store_id = ";
echo $_SESSION["store_id"];
echo ";\n            \n            \n            var stores = [];\n            var default_currency_symbol = null;\n            \n            \$(document).ready(function () {\n                \$(\".sk-circle\").center();\n                \$(\".sk-circle-layer\").show();\n                \n                \$.getJSON(\"?r=settings_info&f=getSettingsInfo\", function (data) {\n                    default_currency_symbol = data.default_currency_symbol;\n                }).done(function () {\n                    getCustomersPayments(0);\n                }); \n            });\n            \n            \n            function addPayment(customer_id){\n                var content =\n                    '<div class=\"modal fade\" id=\"addPaymentModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"payment_info__\" aria-hidden=\"true\">\\n\\\n                    <div class=\"modal-dialog\" role=\"document\">\\n\\\n                        <div class=\"modal-content\">\\n\\\n                            <div class=\"modal-header\"> \\n\\\n                                <h3 class=\"modal-title\"><i class=\"icon-invoice\"></i>&nbsp;Add payment<i style=\"float:right;font-size:30px; cursor:pointer\" class=\"glyphicon glyphicon-remove\" onclick=\"closeModal(\\'addPaymentModal\\')\"></i></h3>\\n\\\n                            </div>\\n\\\n                            <div class=\"modal-body\">\\n\\\n                                <div class=\"row\">\\n\\\n                                    <div class=\"col-lg-4 col-md-4 col-sm-12 col-xs-12\">\\n\\\n                                        <input id=\"payment_value\" value=\"0\" name=\"payment_value\" type=\"text\" class=\"form-control only_numeric\"/>\\n\\\n                                    </div>\\n\\\n                                    <div class=\"col-lg-4 col-md-4 col-sm-12 col-xs-12\">\\n\\\n                                        <button onclick=\"addPaymentToCustomer('+customer_id+')\" style=\"font-size:16px; width:100%\" id=\"add_payment_btn\" type=\"button\" class=\"btn btn-default\">Add payment</button>\\n\\\n                                    </div>\\n\\\n                                </div>\\n\\\n                            </div>\\n\\\n                            <div class=\"modal-footer\">\\n\\\n                            </div>\\n\\\n                        </div>\\n\\\n                    </div>\\n\\\n                </div>';\n                \$(\"#addPaymentModal\").remove();\n                \$(\"body\").append(content);\n                \$(\".only_numeric\").numeric();\n                \$(\"#addPaymentModal\").centerWH();\n\n                \$('#addPaymentModal').modal('toggle');\n\n                \$('#addPaymentModal').on('hidden.bs.modal', function (e) {\n                    \$('#addPaymentModal').remove();\n                });\n            }\n            \n            function addPaymentToCustomer(customer_id){\n                if(\$(\"#payment_value\").val()>=0){\n                    \$(\".sk-circle-layer\").show();\n                    \$(\"#add_payment_btn\").attr(\"disabled\",\"disabled\");\n                    \$.getJSON(\"?r=invoice&f=addCustomerPayment&p0=\" + customer_id +\"&p1=\"+\$(\"#payment_value\").val(), function (data) {\n\n                    }).done(function () {\n                        \$('[data-toggle=\"popover\"]').popover('hide');\n                        \$('#addPaymentModal').modal('toggle');\n                        //\$('[data-toggle=\"popover\"]').remove();\n                        var table = \$('#cutomer_paymets_table').DataTable();\n                        table.ajax.url(\"?r=invoice&f=getAllPaymetsCustomers&p0=\"+current_store_id).load(function () {\n                            \$(\".sk-circle-layer\").hide();\n                        }, false);\n                    });\n                }\n            }\n            \n            function setAction(){\n                var table = \$('#cutomer_paymets_table').DataTable();\n                var p = table.rows({ page: 'current' }).nodes();\n                for (var k = 0; k < p.length; k++){\n                    var index = table.row(p[k]).index();\n                    table.cell(index, 4).data('<button onclick=\"addPayment('+parseInt(table.cell(index, 0).data().split('-')[1])+')\" id=\"pop_'+parseInt(table.cell(index, 0).data().split('-')[1])+'\" type=\"button\" class=\"btn btn-xs btn-info popoverP\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"top\">Add payment</button>');\n                    table.cell(index, 5).data('<button onclick=\"delete_customer('+parseInt(table.cell(index, 0).data().split('-')[1])+')\" type=\"button\" class=\"btn btn-xs btn-danger\">Delete</button>');\n                }\n            }\n            \n            function delete_customer(id){\n                swal({\n                    title: \"Delete customer!!!\",\n                    text: \"Are you sure that you want to delete this customer and all related invoices?\",\n                    type: \"warning\",\n                    showCancelButton: true,\n                    confirmButtonClass: \"btn-danger\",\n                    confirmButtonText: \"Delete now\",\n                    cancelButtonText: \"Cancel\",\n                    closeOnConfirm: true\n                  },\n                function(isconfirm){\n                    if(isconfirm){\n                        \$(\".sk-circle-layer\").show();\n\n                        \$.getJSON(\"?r=customers&f=delete_customer&p0=\" + id, function (data) {\n\n                        }).done(function () {;\n                            var table = \$('#cutomer_paymets_table').DataTable();\n                            table.ajax.url(\"?r=invoice&f=getAllPaymetsCustomers&p0=\"+current_store_id).load(function () {\n                                \$(\".sk-circle-layer\").hide();\n                            }, false);\n                        });\n                    }else{\n                        \n                    }\n                });\n            }\n         \n            function store_changed(){\n                \$(\".sk-circle-layer\").show();\n                var table = \$('#cutomer_paymets_table').DataTable();\n                table.ajax.url(\"?r=invoice&f=getAllPaymetsCustomers&p0=\"+current_store_id).load(function () {\n                    \$(\".sk-circle-layer\").hide();\n                }, false);\n            }\n   \n            function getCustomersPayments(){\n                var search_fields = [0,1];\n                var index = 0;\n                \$('#cutomer_paymets_table tfoot th').each( function () {\n                    if(jQuery.inArray(index, search_fields) !== -1){\n                        var title = \$(this).text();\n                        \$(this).html( '<div class=\"inner-addon left-addon\"><input  style=\"width: 100% !important;\"  class=\"form-control input_sm_search\" type=\"text\" placeholder=\" '+title+'\" /></div>' ); \n                    }\n                    index++;\n                });\n                \n                cutomer_paymets_table = \$('#cutomer_paymets_table').dataTable({\n                    ajax: \"?r=invoice&f=getAllPaymetsCustomers&p0=\"+current_store_id,\n                    orderCellsTop: true,\n                    aoColumnDefs: [\n                        { \"targets\": [0], \"searchable\": true, \"orderable\": true, \"visible\": true },\n                        { \"targets\": [1], \"searchable\": true, \"orderable\": true, \"visible\": true },\n                        { \"targets\": [2], \"searchable\": true, \"orderable\": false, \"visible\": true },\n                        { \"targets\": [3], \"searchable\": true, \"orderable\": false, \"visible\": true },\n                        { \"targets\": [4], \"searchable\": true, \"orderable\": false, \"visible\": true },\n                        { \"targets\": [5], \"searchable\": true, \"orderable\": false, \"visible\": true },\n                    ],\n                    scrollY: '60vh',\n                    scrollCollapse: true,\n                    paging: true,\n                    dom: '<\"toolbar\">frtip',\n                    initComplete: function( settings ) {\n                        \$(\"#cutomer_paymets_table\").show();\n\n                         \n                        \$(\"div.toolbar\").html('<h3><i class=\"icon-invoice\"></i>&nbsp;All Clients payments</h3>\\n\\\n                        <div class=\"btn-group\" role=\"group\" aria-label=\"\">\\n\\\n                        </div>\\n\\\n                        ');\n                        \$('.selectpicker').selectpicker();\n                        \$(\".sk-circle-layer\").hide();\n                    },\n                    footerCallback: function ( row, data, start, end, display ) {\n                        var api = this.api();\n                        \$( api.column( 3 ).footer() ).html(\n                            \"<b style='font-size:16px;color:red'>Total Remain: </b><span style='font-size:15px;'>\"+api.column(3).data().sum().toFixed(3).replace(/(\\d)(?=(\\d\\d\\d)+(?!\\d))/g, \"\$1,\")+\" \"+default_currency_symbol+\"</span>\"\n                        );\n                    },\n                    \n                    fnDrawCallback: setAction,\n                });\n                \n                \$('#cutomer_paymets_table').on( 'page.dt', function () {\n                    \$(\"#tab_toolbar button.blueB\").addClass(\"disabled\");\n                     \n                });\n                \n                \$('#cutomer_paymets_table').DataTable().columns().every( function () {\n                    var that = this;\n                    \$( 'input', this.footer() ).on( 'keyup change', function () {\n                        if ( that.search() !== this.value ) {\n                            that.search( this.value ).draw();\n                        }\n                    } );\n                } );\n            }\n            \n            jQuery.fn.dataTable.Api.register( 'sum()', function ( ) {\n                return this.flatten().reduce( function ( a, b ) {\n                    if ( typeof a === 'string' ) {\n                        a = a.split(' ')[0];\n                        a = a.replace(/[^\\d.-]/g, '') * 1;\n                    }\n                    if ( typeof b === 'string' ) {\n                        b = b.split(' ')[0];\n                        b = b.replace(/[^\\d.-]/g, '') * 1;\n                    }\n\n                    return a + b;\n                }, 0 );\n            } );        \n\n        </script>\n    </head>\n    <body>\n        ";
include "application/mvc/views/topMenu.php";
echo "\n        <div class=\"container-fluid\">\n            <div class=\"row\">\n                <div class=\"col-lg-10\" >           \n                    <table id=\"cutomer_paymets_table\" class=\"table table-striped table-bordered\" cellspacing=\"0\" >\n                        <thead>\n                            <tr> \n                                <th style=\"width: 80px !important;\">Customer ID</th>\n                                 <th>Name</th>\n                                 <th>Address</th>\n                                <th style=\"max-width: 120px;\">Remain</th>  \n                                <th style=\"max-width: 100px;\">Action</th> \n                                <th style=\"max-width: 100px;\">Delete</th> \n                            </tr>\n                        </thead>\n                        <tfoot>\n                            <tr>\n                                <th>Customer ID</th>\n                                 <th>Name</th>\n                                 <th></th>\n                                <th></th>\n                                <th></th>\n                                <th></th>\n                            </tr>\n                        </tfoot>\n                        <tbody></tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"sk-circle-layer\">\n            <div class=\"sk-circle\">\n                <div class=\"sk-circle1 sk-child\"></div>\n                <div class=\"sk-circle2 sk-child\"></div>\n                <div class=\"sk-circle3 sk-child\"></div>\n                <div class=\"sk-circle4 sk-child\"></div>\n                <div class=\"sk-circle5 sk-child\"></div>\n                <div class=\"sk-circle6 sk-child\"></div>\n                <div class=\"sk-circle7 sk-child\"></div>\n                <div class=\"sk-circle8 sk-child\"></div>\n                <div class=\"sk-circle9 sk-child\"></div>\n                <div class=\"sk-circle10 sk-child\"></div>\n                <div class=\"sk-circle11 sk-child\"></div>\n                <div class=\"sk-circle12 sk-child\"></div>\n            </div>\n        </div>\n    </body>\n</html>\n\n";

?>