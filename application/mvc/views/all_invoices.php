<?php
/*
 * @ https://EasyToYou.eu - IonCube v11 Decoder Online
 * @ PHP 5.6
 * @ Decoder version: 1.0.4
 * @ Release: 02/06/2020
 *
 * @ ZendGuard Decoder PHP 5.6
 */

// Decoded file for php version 53.
echo "<!DOCTYPE html>\r\n<!--\r\nTo change this license header, choose License Headers in Project Properties.\r\nTo change this template file, choose Tools | Templates\r\nand open the template in the editor.\r\n-->\r\n<html>\r\n    <head>\r\n        <title>";
echo $_SESSION["page_title"];
echo " Sales Invoices</title>\r\n        <meta charset=\"UTF-8\">\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n        <link rel=\"icon\" type=\"image/png\" href=\"resources/favicon.png\">\r\n        \r\n        <script src=\"libraries/jquery-3.1.1.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-3.3.7-dist/js/bootstrap.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-3.3.7-dist/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        \r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/global.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/global_functions.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        \r\n        <script src=\"application/mvc/views/pos/upsilon-pos_8/gallery.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        \r\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/js/jquery.dataTables.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/js/dataTables.bootstrap.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-plugins/DataTables-1.10.13/media/css/dataTables.bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n  \r\n        <script src=\"libraries/lightbox2-master/dist/js/lightbox.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/lightbox2-master/dist/css/lightbox.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        \r\n        <link href=\"libraries/bootstrap-plugins/datepicker-master/dist/css/bootstrap-datepicker.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <script src=\"libraries/bootstrap-plugins/datepicker-master/dist/js/bootstrap-datepicker.min.js\" type=\"text/javascript\"></script>\r\n        \r\n            <link href=\"application/mvc/views/custom_libraries/css/select2.min.css?v=2\" rel=\"stylesheet\" type=\"text/css\" />\r\n    <script src=\"application/mvc/views/custom_libraries/javascripts/select2.full.min.js\" type=\"text/javascript\"></script>\r\n    \r\n        \r\n        <script src=\"libraries/bootstrap-plugins/bootstrap3-typeahead/bootstrap3-typeahead.js\" type=\"text/javascript\"></script>\r\n\r\n        \r\n        <script src=\"libraries/bootstrap-plugins/DataTables-1.10.13/extensions/Select/js/dataTables.select.min.js\" type=\"text/javascript\"></script>\r\n\r\n        <script src=\"libraries/bootstrap-plugins/bootstrap-select-master/bootstrap-select-master/dist/js/bootstrap-select.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-plugins/bootstrap-select-master/bootstrap-select-master/dist/css/bootstrap-select.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        <link href=\"application/mvc/views/custom_libraries/svgs/font/style.css?rnd=";
echo self::generateRandomStringComplex();
echo "\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <link href=\"application/mvc/views/custom_libraries/css/global.css?rnd=";
echo self::generateRandomStringComplex();
echo "\" rel=\"stylesheet\" type=\"text/css\"/>\r\n\r\n        <link href=\"libraries/bootstrap-plugins/export/buttons.dataTables.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <script src=\"libraries/bootstrap-plugins/export/dataTables.buttons.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/export/jszip.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/export/vfs_fonts.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/export/buttons.html5.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/jquery.mask.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/Buttons-1.2.4/js/buttons.bootstrap.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-plugins/Buttons-1.2.4/css/buttons.bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/autocomplete.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/manual_invoice.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/customers.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>\r\n        \r\n        <script src=\"libraries/bootstrap-plugins/daterangepicker-master/moment.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/bootstrap-plugins/daterangepicker-master/daterangepicker.js\" type=\"text/javascript\"></script>\r\n        <link href=\"libraries/bootstrap-plugins/daterangepicker-master/daterangepicker.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        \r\n        <script src=\"application/mvc/views/custom_libraries/javascripts/latest_prices.js?rnd=";
echo self::generateRandomStringComplex();
echo "\" type=\"text/javascript\"></script>        \r\n\r\n        <link href=\"libraries/bootstrap-plugins/bootstrap-sweetalert-master/dist/sweetalert.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n        <script src=\"libraries/bootstrap-plugins/bootstrap-sweetalert-master/dist/sweetalert.min.js\" type=\"text/javascript\"></script>\r\n        <script src=\"libraries/numeric.js\" type=\"text/javascript\"></script>\r\n        \r\n         <script src=\"libraries/bootstrap-plugins/bootstrap3-typeahead/bootstrap3-typeahead.min.js\" type=\"text/javascript\"></script>\r\n\r\n         <script src=\"libraries/cleave.js-master/dist/cleave.min.js\" type=\"text/javascript\"></script>\r\n\r\n         <script src=\"libraries/jquery-toast-plugin-master/dist/jquery.toast.min.js\" type=\"text/javascript\"></script>\r\n         <link href=\"libraries/jquery-toast-plugin-master/dist/jquery.toast.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\r\n\r\n         <script src=\"application/mvc/views/custom_libraries/javascripts/jquery-confirm.min.js\" type=\"text/javascript\"></script>\r\n        <link href=\"application/mvc/views/custom_libraries/css/jquery-confirm.min.css\" rel=\"stylesheet\" type=\"text/css\" /> \r\n        \r\n        \r\n        <style type=\"text/css\">\r\n            \r\n   \r\n            \r\n            .select2-search__field {\r\n                    z-index: 99999999; /* or higher value */\r\n                }\r\n\r\n            \r\n            ul.typeahead.dropdown-menu {\r\n                max-height: 300px;\r\n                overflow: auto;\r\n            }\r\n\r\n            .container,.panel {\r\n                height:100%;\r\n                width: 100%;\r\n                padding: 0px !important;\r\n                margin: 0px !important;\r\n            }\r\n            \r\n            .table>tfoot>tr>th{\r\n                font-size: 12px !important;\r\n                background-color: #F3F3F3;\r\n                padding: 2px;\r\n                border: none !important;\r\n            }\r\n            \r\n            .dataTables_filter { display: none; }\r\n            \r\n            .selected{\r\n                background-color: #337ab7 !important;\r\n                color: #ffffff !important;\r\n            }\r\n            \r\n            .search_filter{\r\n                width: 100% !important;\r\n                color: #000;\r\n            }\r\n            \r\n            \r\n            ::-webkit-input-placeholder { /* Chrome/Opera/Safari */\r\n                color: #337ab7;\r\n                opacity: 0.9;\r\n            }\r\n            ::-moz-placeholder { /* Firefox 19+ */\r\n                color: #337ab7;\r\n                opacity: 0.9;\r\n            }\r\n            :-ms-input-placeholder { /* IE 10+ */\r\n                color: #337ab7;\r\n                opacity: 0.9;\r\n            }\r\n            :-moz-placeholder { /* Firefox 18- */\r\n                color: #337ab7;\r\n                opacity: 0.9;\r\n            }\r\n            \r\n            /* enable absolute positioning */\r\n            .inner-addon { \r\n                position: relative; \r\n            }\r\n\r\n            /* style icon */\r\n            .inner-addon .glyphicon {\r\n              position: absolute;\r\n              padding: 6px;\r\n              pointer-events: none;\r\n            }\r\n\r\n            /* align icon */\r\n            .left-addon .glyphicon  { left:  0px;}\r\n            .right-addon .glyphicon { right: 0px;}\r\n\r\n            /* add padding  */\r\n            .left-addon input  { padding-left:  5px; }\r\n            .right-addon input { padding-right: 30px; }\r\n            \r\n            .phone-input{\r\n                    margin-bottom:8px;\r\n            }\r\n            \r\n            .confirmation {\r\n                width: 160px;\r\n            }\r\n            \r\n            .list-group-item{\r\n                border: none !important;\r\n            }\r\n            \r\n            div.toolbar h3{\r\n                margin-top: 0px !important;\r\n            }\r\n            \r\n            .dataTable>tfoot>tr>th{\r\n                /* width: 50px !important; */\r\n            }\r\n            \r\n            .item_icon{\r\n                font-size: 18px;\r\n            }\r\n            .addon_item_icon input{\r\n                padding-left: 30px !important;\r\n            }\r\n            \r\n            .opened{\r\n                color:red;\r\n                font-weight: bold\r\n            }\r\n            \r\n            .btn-xs{\r\n                font-size: 14px !important;\r\n                padding-top: 0px !important;\r\n                width: 100%\r\n            }\r\n            \r\n            .input-sm{\r\n                \r\n            }\r\n            \r\n            .payInput{\r\n                width: 70px;\r\n                height: 28px;\r\n                text-align: center;\r\n            }\r\n            \r\n            .unpaid{\r\n                color: #CC0000\r\n            }\r\n            \r\n            .btn-group-xs>.btn, .btn-xs{\r\n                line-height: 1.3 !important;\r\n             }\r\n             \r\n             .linethrough{\r\n                text-decoration: line-through;\r\n                color: #CC0000 !important;\r\n            }\r\n             \r\n             .offcial_input{\r\n                 width:100%;\r\n                 color: #000;\r\n                 font-size: 14px;\r\n                 height: 23px;\r\n             }\r\n             \r\n             .panel > .panel-heading{\r\n                padding: 1px 6px  !important;\r\n            }\r\n        </style>\r\n        <script type=\"text/javascript\">\r\n            var invoices_table = null;\r\n            var current_customer_id = 0;\r\n            var current_store_id = null;\r\n            \r\n            var all_invoices_hide_col = \"\";\r\n            \r\n            var currency = \"";
echo $data["currency"];
echo "\";\r\n            \r\n            var multibranches = \"";
echo $data["enable_new_multibranches"];
echo "\";\r\n            \r\n            var accessbranches = JSON.stringify(";
echo json_encode($data["branches"]);
echo ");\r\n            \r\n            \r\n            \r\n            \r\n            var current_date = \"today\";\r\n            \r\n            var role_id = ";
echo $_SESSION["role"];
echo ";\r\n            var print_a4_pdf_version = ";
if (isset($data["print_a4_pdf_version"])) {
    echo $data["print_a4_pdf_version"];
} else {
    echo "0";
}
echo ";\r\n            var stores = [];\r\n            \r\n            var current_invoice_filter = 0;\r\n            var all_currencies = [];\r\n            \r\n            var salesperson = \"\";\r\n            var vendors_oprions=\"\";\r\n            \r\n            \r\n            function check_if_col_hide(id){\r\n                for(var i=0;i<all_invoices_hide_col.length;i++){\r\n                    if(all_invoices_hide_col[i]==id){\r\n                        return false;\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n            \r\n            \$(document).ready(function () {\r\n                \r\n                \$(\".sk-circle\").center();\r\n                \$(\".sk-circle-layer\").show();\r\n                \r\n                \r\n                \$.getJSON(\"?r=settings_info&f=get_needed_data\", function (data) {\r\n                    all_currencies = [];\r\n                    \$.each(data.currencies, function (key, val) {\r\n                        all_currencies.push({id:val.id,name:val.name,symbole:val.symbole,system_default:val.system_default,rate_to_system_default:val.rate_to_system_default});\r\n                    }); \r\n                    \r\n                    salesperson+='<option value=\"0\" title=\"All Salesperson\">All Salesperson</option>';\r\n                    \$.each(data.employees, function (key, val) {\r\n                        salesperson+='<option value=\"'+val.id+'\" title=\"'+val.first_name+' '+val.last_name+'\">'+val.first_name+' '+val.last_name+'</option>';\r\n                    });\r\n                    \r\n                    vendors_oprions+='<option value=\"0\" title=\"All Vendors\">All Vendors</option>';\r\n                    \$.each(data.vendors_created_invoices, function (key, val) {\r\n                        vendors_oprions+='<option value=\"'+val.id+'\" title=\"'+val.username+'\">'+val.username+'</option>';\r\n                    });\r\n                    \r\n                    \r\n                   all_invoices_hide_col = data.all_invoices_hide_col.split(',');\r\n                 \r\n                }).done(function () {\r\n                    getInvoicesOfCustomer(0);\r\n                });\r\n                /*\r\n                \$.getJSON(\"?r=store&f=getStores\", function (data) {\r\n                    \$.each(data, function (key, val) {\r\n                        if(current_store_id == null){\r\n                            current_store_id = val.id;\r\n                        }\r\n                        stores.push({id:val.id,location:val.location,name:val.name});\r\n                    });\r\n                }).done(function () {\r\n                    getInvoicesOfCustomer(0);\r\n                });*/\r\n            });\r\n            \r\n            function check_role(){\r\n                if(role_id==3){\r\n                    return false;\r\n                }\r\n                return true;\r\n            }\r\n            \r\n            function paid_unpaid_selection_changed(object){\r\n                \$.getJSON(\"?r=invoice&f=set_status&p0=\"+\$(object).attr(\"id\").split(\"_\")[1], function (data) {\r\n        \r\n                }).done(function () {\r\n                    refresh_invoices_table();\r\n                });\r\n            }\r\n            \r\n            function updateRows(){\r\n                var table = \$('#invoices_table').DataTable();\r\n                var p = table.rows({ page: 'current' }).nodes();\r\n                for (var k = 0; k < p.length; k++){\r\n                    var index = table.row(p[k]).index();\r\n                    \r\n                    if(table.cell(index,17).data()==\"1\"){\r\n                        \$(table.row(p[k]).node()).addClass(\"linethrough\");\r\n                    }\r\n                    \r\n                    var addp =\"\";\r\n                    if(table.cell(index,1).data()!=\"\" && table.cell(index,17).data()==\"0\"){\r\n                        addp = '&nbsp;&nbsp;<i class=\"glyphicon icon-payment\" title=\"Add Payment\" onclick=\"add_payment(\\''+table.cell(index,1).data().split(\"-\")[1]+'\\')\" style=\"font-size:20px; cursor:pointer\"></i>';\r\n                    }\r\n                    \r\n                    var delete_btn=\"\";\r\n                    if(table.cell(index,17).data()==\"0\"){\r\n                        delete_btn=\"&nbsp;<i title='Delete' class='glyphicon glyphicon-trash red' style='font-size:18px;cursor:pointer' onclick='delete_manual_invoice(\"+parseInt(table.cell(index, 0).data().split(\"-\")[1])+\")'></i>\";\r\n                    }\r\n                    \r\n                    if(table.cell(index,17).data()==\"0\"){\r\n                        if(print_a4_pdf_version==1){\r\n                            table.cell(index,14).data('<i title=\"print\" class=\"glyphicon glyphicon-print\" onclick=\"print_sheet_pdf(\\''+parseInt(table.cell(index, 0).data().split(\"-\")[1])+'\\')\" style=\"font-size:18px;cursor:pointer\" ></i>&nbsp;&nbsp;<i title=\"Edit\" class=\"glyphicon glyphicon-edit\" onclick=\"edit_manual_invoice(\\''+parseInt(table.cell(index, 0).data().split(\"-\")[1])+'\\')\" style=\"font-size:18px;cursor:pointer\" ></i>'+addp+delete_btn);\r\n                        }else{\r\n                            table.cell(index,14).data('<i title=\"print\" class=\"glyphicon glyphicon-print\" onclick=\"print_sheet(\\''+parseInt(table.cell(index, 0).data().split(\"-\")[1])+'\\')\" style=\"font-size:18px;cursor:pointer\" ></i>&nbsp;&nbsp;<i title=\"Edit\" class=\"glyphicon glyphicon-edit\" onclick=\"edit_manual_invoice(\\''+parseInt(table.cell(index, 0).data().split(\"-\")[1])+'\\')\" style=\"font-size:18px;cursor:pointer\" ></i>'+addp+delete_btn);\r\n                        }\r\n                        //print_sheet_pdf\r\n                    }\r\n                    \r\n                    if(table.cell(index,17).data()==\"1\"){\r\n                        table.cell(index,16).data(\"\");\r\n                    }\r\n                }\r\n            }\r\n            \r\n            function setoffcial(id,action){\r\n                \$(\".sk-circle-layer\").show();\r\n                \$.getJSON(\"?r=invoice&f=set_invoice_official&p0=\"+id+\"&p1=\"+action, function (data) {\r\n                    \r\n                }).done(function () {\r\n                    var table = \$('#invoices_table').DataTable();\r\n                    table.ajax.url(\"?r=invoice&f=getAllInvoicesDateRange&p0=\"+current_store_id+\"&p1=\"+current_date+\"&p2=\"+current_invoice_filter+\"&p3=\"+\$(\"#filter_salesperson\").val()+\"&p4=\"+\$(\"#filter_vendors\").val()+\"&p5=\"+\$(\"#filter_taxable\").val()).load(function () {\r\n                        \$(\".sk-circle-layer\").hide();\r\n                    }, false);\r\n                });\r\n            }\r\n            \r\n            \r\n            \r\n            function updateInvoicePayment(){\r\n                var table = \$('#invoices_table').DataTable();\r\n                var p = table.rows({ page: 'current' }).nodes();\r\n                for (var k = 0; k < p.length; k++){\r\n                    var index = table.row(p[k]).index();\r\n                    table.cell(index, 6).data('<button id=\"pop_'+parseInt(table.cell(index, 0).data().split('-')[1])+'\" type=\"button\" class=\"btn btn-xs btn-info popoverP\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"top\">Add payment</button>');\r\n                        \$(\"#pop_\"+parseInt(table.cell(index, 0).data().split('-')[1])).popover({\r\n                           trigger: 'click',\r\n                           content: '<b>Value of Payment</b><br/><input type=\"text\" class=\"payInput\" id=\"inp_'+parseInt(table.cell(index, 0).data().split('-')[1])+'\">&nbsp;<button  type=\"button\" class=\"btn btn-info btn-sm \" onclick=\"addPaymentToInvoice('+parseInt(table.cell(index, 0).data().split('-')[1])+','+parseInt(table.cell(index, 1).data().split('-')[1])+')\">Add</button>',\r\n                           html: true\r\n                        });\r\n                }\r\n\r\n                \$('body').on('click', function (e) {\r\n                    \$('[data-toggle=\"popover\"]').each(function () {\r\n                        if (!\$(this).is(e.target) && \$(this).has(e.target).length === 0 && \$('.popover').has(e.target).length === 0) {\r\n                            \$(this).popover('hide');\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n            \r\n            //\"?r=invoice&f=addCustomerPayment&p0=\"+\$(\"#customer_id\").val()+\"&p1=\"+\$(\"#pay_val\").val()\r\n            function addPaymentToInvoice(invoice_id,customer_id){\r\n                \$(\".sk-circle-layer\").show();\r\n                \$.getJSON(\"?r=invoice&f=addCustomerPayment&p0=\" + customer_id + \"&p1=\"+\$(\"#inp_\"+invoice_id).val(), function (data) {\r\n                    \r\n                }).done(function () {\r\n                    \$('[data-toggle=\"popover\"]').popover('hide');\r\n                    //\$('[data-toggle=\"popover\"]').remove();\r\n                    var table = \$('#invoices_table').DataTable();\r\n                    table.ajax.url(\"?r=invoice&f=getAllInvoicesDateRange&p0=\"+current_store_id+\"&p1=\"+current_date+\"&p2=\"+current_invoice_filter+\"&p3=\"+\$(\"#filter_salesperson\").val()+\"&p4=\"+\$(\"#filter_vendors\").val()+\"&p5=\"+\$(\"#filter_taxable\").val()).load(function () {\r\n                        \$(\".sk-circle-layer\").hide();\r\n                    }, false);\r\n                });\r\n            }\r\n          \r\n      \r\n            function closeInvoice(id){\r\n                \$(\".sk-circle-layer\").show();\r\n                \$.getJSON(\"?r=invoice&f=close_invoice&p0=\" + id, function (data) {\r\n                    \r\n                }).done(function () {\r\n                    var table = \$('#invoices_table').DataTable();\r\n                    table.ajax.url(\"?r=invoice&f=getAllInvoicesDateRange&p0=\"+current_store_id+\"&p1=\"+current_date+\"&p2=\"+current_invoice_filter+\"&p3=\"+\$(\"#filter_salesperson\").val()+\"&p4=\"+\$(\"#filter_vendors\").val()+\"&p5=\"+\$(\"#filter_taxable\").val()).load(function () {\r\n                            \$(\".sk-circle-layer\").hide();\r\n                    }, false);\r\n                });\r\n            }\r\n         \r\n            function store_changed(){\r\n                current_date = \$(\"#salesDate\").val();\r\n                \$(\".sk-circle-layer\").show();\r\n                current_store_id = \$(\"#store_list\").val();\r\n                var table = \$('#invoices_table').DataTable();\r\n                table.ajax.url(\"?r=invoice&f=getAllInvoicesDateRange&p0=\"+current_store_id+\"&p1=\"+current_date+\"&p2=\"+current_invoice_filter+\"&p3=\"+\$(\"#filter_salesperson\").val()+\"&p4=\"+\$(\"#filter_vendors\").val()+\"&p5=\"+\$(\"#filter_taxable\").val()).load(function () {\r\n                    \$(\".sk-circle-layer\").hide();\r\n                }, false);\r\n            }\r\n            \r\n            function refresh_invoices_table(){\r\n                current_invoice_filter = \$(\"#filter_official\").val();\r\n                current_date = \$(\"#salesDate\").val();\r\n                \$(\".sk-circle-layer\").show();\r\n                current_store_id = \$(\"#store_list\").val();\r\n                var table = \$('#invoices_table').DataTable();\r\n                table.ajax.url(\"?r=invoice&f=getAllInvoicesDateRange&p0=\"+current_store_id+\"&p1=\"+current_date+\"&p2=\"+current_invoice_filter+\"&p3=\"+\$(\"#filter_salesperson\").val()+\"&p4=\"+\$(\"#filter_vendors\").val()+\"&p5=\"+\$(\"#filter_taxable\").val()).load(function () {\r\n                    \$(\".sk-circle-layer\").hide();\r\n                }, false);\r\n            }\r\n   \r\n            var _total_clients_balance=0;\r\n            var _total_amounts=0;\r\n            var _total_profits=0;\r\n            \r\n            function getInvoicesOfCustomer(){\r\n                var search_fields = [0,1,2,3,4,5,6,7,8,9,10,11,12];\r\n                var index = 0;\r\n                \$('#invoices_table tfoot th').each( function () {\r\n                    if(jQuery.inArray(index, search_fields) !== -1){\r\n                        var title = \$(this).text();\r\n                        \$(this).html( '<div class=\"inner-addon left-addon\"><input  style=\"width: 100% !important;\"  class=\"form-control input_sm_search\" type=\"text\" placeholder=\" '+title+'\" /></div>' ); \r\n                    }\r\n                    index++;\r\n                });\r\n                \r\n                invoices_table = \$('#invoices_table').dataTable({\r\n                    ajax: {\r\n                        url: \"?r=invoice&f=getAllInvoicesDateRange&p0=\"+current_store_id+\"&p1=\"+current_date+\"&p2=\"+current_invoice_filter+\"&p3=\"+\$(\"#filter_salesperson\").val()+\"&p4=0&p5=0\",\r\n                        type: 'POST',\r\n                        error:function(xhr,status,error) {\r\n                        },\r\n                        dataSrc: function(json) {\r\n                            if(\$(\"#total_clients_balance\").length>0){\r\n                                \$(\"#total_clients_balance\").html(json.total_clients_balance+\" <small class='currency'>\"+currency+\"</small>\");\r\n                                _total_clients_balance=0;\r\n                                \r\n                                \$(\"#_total_amounts\").html(json._total_amounts+\" <small class='currency'>\"+currency+\"</small>\");\r\n                                _total_amounts=0;\r\n                                \r\n                                \$(\"#_total_profits\").html(json._total_profits+\" <small class='currency'>\"+currency+\"</small>\");\r\n                                _total_profits=0;\r\n                            }else{\r\n                                _total_clients_balance=json.total_clients_balance;\r\n                                _total_amounts=json._total_amounts;\r\n                                _total_profits=json._total_profits;\r\n                            }\r\n                            \r\n                            \r\n                            return json.data;\r\n                        }\r\n                    },\r\n                    orderCellsTop: true,\r\n                    aoColumnDefs: [\r\n                        { \"targets\": [0], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                        { \"targets\": [1], \"searchable\": true, \"orderable\": true, \"visible\": false },\r\n                        { \"targets\": [2], \"searchable\": true, \"orderable\": true, \"visible\": check_if_col_hide(2) },\r\n                        { \"targets\": [3], \"searchable\": true, \"orderable\": true, \"visible\": check_if_col_hide(3) },\r\n                        { \"targets\": [4], \"searchable\": true, \"orderable\": true, \"visible\": check_if_col_hide(4) },\r\n                        { \"targets\": [5], \"searchable\": true, \"orderable\": true, \"visible\": check_if_col_hide(5) },\r\n                        { \"targets\": [6], \"searchable\": true, \"orderable\": true, \"visible\": check_if_col_hide(6) },\r\n                        { \"targets\": [7], \"searchable\": true, \"orderable\": true, \"visible\": false },\r\n                        { \"targets\": [8], \"searchable\": true, \"orderable\": true, \"visible\": false },\r\n                        { \"targets\": [9], \"searchable\": true, \"orderable\": true, \"visible\": false },\r\n                        { \"targets\": [10], \"searchable\": true, \"orderable\": false, \"visible\": false },\r\n                        { \"targets\": [11], \"searchable\": true, \"orderable\": true, \"visible\": check_if_col_hide(11) },\r\n                        { \"targets\": [12], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                        { \"targets\": [13], \"searchable\": true, \"orderable\": true, \"visible\": true },\r\n                        { \"targets\": [14], \"searchable\": true, \"orderable\": false, \"visible\": check_if_col_hide(13) },\r\n                        { \"targets\": [15], \"searchable\": true, \"orderable\": false, \"visible\": false },\r\n                        { \"targets\": [16], \"searchable\": true, \"orderable\": false, \"visible\": false },\r\n                        { \"targets\": [17], \"searchable\": true, \"orderable\": false, \"visible\": false },\r\n                    ],\r\n                    scrollY: '47vh',\r\n                    scrollCollapse: true,\r\n                    \"paging\": true,           // Enable pagination\r\n                    \"pageLength\": 50, \r\n                    \"lengthChange\": true,\r\n                    \"lengthMenu\": [50, 100, 250, 500], // Page length options \r\n                    //dom: '<\"toolbar\">frtlip',\r\n                    dom: '<\"row\"<\"col-sm-12 col-md-12\"<\"toolbar\">>><\"row\"<\"col-sm-12 col-md-6\"f>>' +\r\n                    '<\"row\"<\"col-sm-12\"tr>>' +\r\n                    '<\"row\"<\"col-sm-4 col-md-4\"l><\"col-sm-4 col-md-4\"i><\"col-sm-4 col-md-4\"p>>',\r\n                    initComplete: function( settings ) {\r\n                        \$(\"#invoices_table\").show();\r\n                        \r\n                        var table = \$('#invoices_table').DataTable();\r\n                        //table.row(':eq(0)', { page: 'current' }).select();\r\n                        \r\n                        var stores_option = \"\";\r\n                        for(var i=0;i<stores.length;i++){\r\n                            stores_option+='<option value='+stores[i].id+' title=\"'+stores[i].name+'\">'+stores[i].name+'</option>';\r\n                        }\r\n                        \r\n                        var create_btn_v='<div class=\"col-lg-1 col-md-1 col-sm-12 pl2 pr2\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%;\">\\n\\\r\n                                    <button type=\"button\" class=\"btn btn-primary\" onclick=\"manual_invoice_generate_invoice()\" style=\"width:100%;\">Create Invoice</button>\\n\\\r\n                                </div>\\n\\\r\n                            </div>';\r\n                        if(multibranches==1){\r\n                            create_btn_v='<div class=\"col-lg-1 col-md-1 col-sm-12 pl2 pr2\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%;\">\\n\\\r\n                                    <button type=\"button\" class=\"btn btn-primary\" onclick=\"manual_invoice_generate_invoice_multi_branches()\" style=\"width:100%;\">Create Invoice</button>\\n\\\r\n                                </div>\\n\\\r\n                            </div>';\r\n                        }\r\n                        \r\n                         \r\n                        \$(\"div.toolbar\").html('<h3><i class=\"icon-invoice\"></i>&nbsp;Sales invoices</h3>\\n\\\r\n                        <div class=\"row\">\\n\\\r\n                            <div class=\"col-lg-2 col-md-2 col-sm-12 pr5\" style=\"display:none\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\">\\n\\\r\n                                    <select id=\"store_list\" class=\"selectpicker\" onchange=\"store_changed()\">\\n\\\r\n                                        '+stores_option+'\\n\\\r\n                                    </select>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"col-lg-2 col-md-2 col-sm-12 pr2\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%;\">\\n\\\r\n                                    <input id=\"salesDate\" class=\"form-control datepicker\" type=\"text\" placeholder=\"Select date\" style=\"cursor:pointer; width:100%;\">\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"col-lg-2 col-md-2 col-sm-12 pl2 pr2\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%\">\\n\\\r\n                                    <select data-width=\"100%\" id=\"filter_official\" class=\"selectpicker\" onchange=\"refresh_invoices_table()\">\\n\\\r\n                                        <option value=\"0\" title=\"All Invoices\">All Invoices</option>\\n\\\r\n                                        <option value=\"1\" title=\"Only Unpaid\">Only Unpaid</option>\\n\\\r\n                                        <option value=\"2\" title=\"Only Paid\">Only Paid</option>\\n\\\r\n                                    </select>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"col-lg-2 col-md-2 col-sm-12 pl2 pr2\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%\">\\n\\\r\n                                    <select data-live-search=\"true\" data-width=\"100%\" id=\"filter_salesperson\" class=\"selectpicker\" onchange=\"refresh_invoices_table()\">\\n\\\r\n                                        '+salesperson+'\\n\\\r\n                                    </select>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"col-lg-2 col-md-2 col-sm-12 pl2 pr2\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%\">\\n\\\r\n                                    <select data-live-search=\"true\" data-width=\"100%\" id=\"filter_vendors\" class=\"selectpicker\" onchange=\"refresh_invoices_table()\">\\n\\\r\n                                        '+vendors_oprions+'\\n\\\r\n                                    </select>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"col-lg-2 col-md-2 col-sm-12 pl2 pr2\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%\">\\n\\\r\n                                    <select data-live-search=\"true\" data-width=\"100%\" id=\"filter_taxable\" class=\"selectpicker\" onchange=\"refresh_invoices_table()\">\\n\\\r\n                                        <option value=\"0\" selected title=\"All Taxable or Not\">All Taxable or Not</option>\\n\\\r\n                                        <option value=\"1\" title=\"Taxable\">Taxable</option>\\n\\\r\n                                        <option value=\"2\" title=\"Not Taxable\">Not Taxable</option>\\n\\\r\n                                    </select>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                            '+create_btn_v+'\\n\\\r\n                            <div class=\"col-lg-1 col-md-1 col-sm-2 pl2\" >\\n\\\r\n                                <div class=\"btn-group\" role=\"group\" aria-label=\"\" style=\"width:100%\">\\n\\\r\n                                    <div class=\"btn-group\" id=\"buttons\" style=\"float:right\"></div>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                        </div>\\n\\\r\n                        <div class=\"row\" style=\"margin-top:5px;\">\\n\\\r\n                            <div class=\"col-md-2 col-sm-3\" style=\"padding-right:2px;\">\\n\\\r\n                                <div class=\"panel panel-info\">\\n\\\r\n                                    <div class=\"panel-heading\">\\n\\\r\n                                        <div class=\"row\">\\n\\\r\n                                            <div class=\"col-xs-12 col-sm-12 text-left\">\\n\\\r\n                                                <b class=\"announcement-heading dollar\" id=\"total_clients_balance\">0 <small class=\"currency\">'+currency+'</small></b>\\n\\\r\n                                                <p class=\"announcement-text\" style=\"margin-bottom:0px;\">Clients\\' Total Balances</p>\\n\\\r\n                                            </div>\\n\\\r\n                                        </div>\\n\\\r\n                                    </div>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"col-md-2 col-sm-3\" style=\"padding-left:2px;padding-right:2px;\">\\n\\\r\n                                <div class=\"panel panel-info\">\\n\\\r\n                                    <div class=\"panel-heading\">\\n\\\r\n                                        <div class=\"row\">\\n\\\r\n                                            <div class=\"col-xs-12 col-sm-12 text-left\">\\n\\\r\n                                                <b class=\"announcement-heading dollar\" id=\"_total_amounts\">0 <small class=\"currency\">'+currency+'</small></b>\\n\\\r\n                                                <p class=\"announcement-text\" style=\"margin-bottom:0px;\">Total Invoices Amount</p>\\n\\\r\n                                            </div>\\n\\\r\n                                        </div>\\n\\\r\n                                    </div>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                            <div class=\"col-md-2 col-sm-3\" style=\"padding-left:2px;padding-right:2px;\">\\n\\\r\n                                <div class=\"panel panel-success\">\\n\\\r\n                                    <div class=\"panel-heading\">\\n\\\r\n                                        <div class=\"row\">\\n\\\r\n                                            <div class=\"col-xs-12 col-sm-12 text-left\">\\n\\\r\n                                                <b class=\"announcement-heading dollar\" id=\"_total_profits\">0 <small class=\"currency\">'+currency+'</small></b>\\n\\\r\n                                                <p class=\"announcement-text\" style=\"margin-bottom:0px;\">Total Profits</p>\\n\\\r\n                                            </div>\\n\\\r\n                                        </div>\\n\\\r\n                                    </div>\\n\\\r\n                                </div>\\n\\\r\n                            </div>\\n\\\r\n                        </div>\\n\\\r\n                        ');\r\n    \r\n    \r\n                        var buttons = new \$.fn.dataTable.Buttons(table, {\r\n                            buttons: [\r\n                              {\r\n                                    extend: 'excel',\r\n                                    text: 'Export excel',\r\n                                    className: 'exportExcel',\r\n                                    filename: 'Invoices',\r\n                                    customize: _customizeExcelOptions,\r\n                                    exportOptions: {\r\n                                        modifier: {\r\n                                            page: 'all'\r\n                                        },\r\n                                        columns: [0,2,3,4,5,7,10,11,12,13],\r\n                                        format: {\r\n                                            body: function ( data, row, column, node ) {\r\n                                                // Strip \$ from salary column to make it numeric\r\n                                                return  data; //column == 8 ? parseInt(table.cell(row,0).data()) :\r\n                                            }\r\n                                        }\r\n                                    }\r\n                              }\r\n                            ]\r\n                            \r\n                       }).container().appendTo(\$('#buttons'));\r\n                       \r\n                       function _customizeExcelOptions(xlsx) {\r\n                           var sheet = xlsx.xl.worksheets['sheet1.xml'];\r\n                            var clR = \$('row', sheet);\r\n                            //var r1 = Addrow(clR.length+2, [{key:'A',value: \"Total Credit Notes\"},{key:'B',value: total}]);\r\n                            //sheet.childNodes[0].childNodes[1].innerHTML = sheet.childNodes[0].childNodes[1].innerHTML + r1;\r\n                            \r\n                            //\$('row c[r^=\"A'+(clR.length+2)+'\"]', sheet).attr('s', '48');\r\n                            \r\n                            function Addrow(index, data) {\r\n                                var msg = '<row r=\"' + index + '\">'\r\n                                for (var i = 0; i < data.length; i++) {\r\n                                    var key = data[i].key;\r\n                                    var value = data[i].value;\r\n                                    msg += '<c t=\"inlineStr\" r=\"' + key + index + '\">';\r\n                                    msg += '<is>';\r\n                                    msg += '<t>' + value + '</t>';\r\n                                    msg += '</is>';\r\n                                    msg += '</c>';\r\n                                }\r\n                                msg += '</row>';\r\n                                return msg;\r\n                            }\r\n                       }\r\n                       \r\n                        \$('.selectpicker').selectpicker();\r\n                        \r\n                        \r\n                        \r\n                        var defaultStart = moment().startOf('month');\r\n                        var end = moment();\r\n                        \r\n                        \$( \"#salesDate\" ).daterangepicker({\r\n                            //dateLimit:{month:12},\r\n                            startDate: defaultStart,\r\n                            endDate: end,\r\n                            locale: {\r\n                                format: 'YYYY-MM-DD'\r\n                            },\r\n                            ranges: {\r\n                                'Today': [moment(), moment()],\r\n                                'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],\r\n                                'Last 7 Days': [moment().subtract(6, 'days'), moment()],\r\n                                'Last 30 Days': [moment().subtract(29, 'days'), moment()],\r\n                                'This Month': [moment().startOf('month'), moment().endOf('month')],\r\n                                'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]\r\n                             }\r\n                        });\r\n                        \r\n                        \$( \"#salesDate\" ).change(function() {\r\n                            store_changed();\r\n                        });\r\n                        //if(_total_clients_balance>0){\r\n                            \$(\"#total_clients_balance\").html(_total_clients_balance+\" <small class='currency'>\"+currency+\"</small>\");\r\n                            \$(\"#_total_amounts\").html(_total_amounts+\" <small class='currency'>\"+currency+\"</small>\");\r\n                            \$(\"#_total_profits\").html(_total_profits+\" <small class='currency'>\"+currency+\"</small>\");\r\n                            \r\n                        //}\r\n                        \r\n                        \r\n                        \$(\".sk-circle-layer\").hide();\r\n                    },\r\n                    fnDrawCallback: updateRows,\r\n                    fnRowCallback: function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {\r\n                        //\$(nRow).addClass(aData[0]);\r\n                    },\r\n                });\r\n                \r\n                \$('#invoices_table').on( 'page.dt', function () {\r\n                    \$(\"#tab_toolbar button.blueB\").addClass(\"disabled\");\r\n                     updateRows();\r\n                });\r\n                \r\n                \$('#invoices_table').DataTable().columns().every( function () {\r\n                    var that = this;\r\n                    \$( 'input', this.footer() ).on( 'keyup change', function () {\r\n                        if ( that.search() !== this.value ) {\r\n                            that.search( this.value ).draw();\r\n                        }\r\n                    } );\r\n                } );\r\n                \r\n                \$('#invoices_table').DataTable().on('mousedown',\"tr\", function ( e, dt, type, indexes ) { \r\n                    \$('.selected').removeClass(\"selected\");\r\n                    \$(this).addClass('selected');\r\n                });\r\n\r\n\r\n                \$('#invoices_table').on('click', 'td', function () {\r\n                    if (\$(this).index() == 4 || \$(this).index() == 5) {\r\n                        //return false;\r\n                    }\r\n                });\r\n            }\r\n            \r\n            function add_payment(customer_id){\r\n                if(parseFloat(customer_id)>0){\r\n                    \$(\".sk-circle\").center();\r\n                    \$(\".sk-circle-layer\").show();\r\n                    addCustomerPaymentDetails(customer_id,0,[],\"invoicesadmin\");\r\n                }else{\r\n                    swal(\"Customer not found\");\r\n                } \r\n            }\r\n            \r\n            function official_changed(invoice_id){\r\n                \$.getJSON(\"?r=invoice&f=set_official_nb_manual&p0=\"+invoice_id+\"&p1=\"+\$(\"#off_id_\"+invoice_id).val(), function (data) {\r\n                    \r\n                }).done(function () {\r\n                    \r\n                });\r\n            }\r\n\r\n        </script>\r\n    </head>\r\n    <body>\r\n        ";
include "application/mvc/views/topMenu.php";
echo "\r\n        <div class=\"container\" >\r\n            <div class=\"panel panel-default\">\r\n                <div class=\"panel-body\" style=\"margin-top: 50px;\">\r\n                    <div class=\"row\"  >\r\n                        <div class=\"col-lg-12\" >           \r\n                            <table id=\"invoices_table\" class=\"table table-striped table-bordered\" cellspacing=\"0\" >\r\n                                <thead>\r\n                                    <tr> \r\n                                        <th style=\"width: 70px !important;\">INV. NB</th>\r\n                                        <th style=\"width: 75px !important;\">Customer ID</th>\r\n                                        <th>Customer Name</th>\r\n                                        <th style=\"width: 95px !important;\">Starting Balance</th>\r\n                                        <th style=\"width: 120px !important;\">Sales Person</th>\r\n                                        <th style=\"width: 100px !important;\">Invoice date</th>\r\n                                        <th style=\"width: 80px !important;\">Amount</th>\r\n                                        <th style=\"width: 80px !important;\">Amount</th>\r\n                                        <th style=\"width: 50px !important;\">Status</th>\r\n                                        <th style=\"width: 75px !important;\">Remain</th>\r\n                                        <th style=\"width: 75px !important;\">Remain</th>\r\n                                        <th style=\"width: 75px !important;\">Profit</th> \r\n                                        <th style=\"width: 75px !important;\">Balance</th>  \r\n                                        <th style=\"width: 60px !important;\">Status</th> \r\n                                        <th style=\"width: 90px !important;\"></th> \r\n                                        <th style=\"width: 60px !important;\">Status</th> \r\n                                        <th style=\"width: 40px !important;\">Off. NB</th> \r\n                                        <th style=\"width: 40px !important;\">Delete</th> \r\n                                    </tr>\r\n                                </thead>\r\n                                <tfoot>\r\n                                    <tr>\r\n                                        <th>Invoice ID</th>\r\n                                        <th>Customer ID</th>\r\n                                        <th>Customer Name</th>\r\n                                        <th>Starting Balance</th>\r\n                                        <th>Sales Person</th>\r\n                                        <th>Invoice date</th>\r\n                                        <th>Amount</th>\r\n                                        <th>Amount</th>\r\n                                        <th>Status</th>\r\n                                        <th>Remain</th>\r\n                                        <th>Remain</th>\r\n                                        <th>Profit</th>\r\n                                        <th>Balance</th>\r\n                                        <th>&nbsp;</th>\r\n                                        <th></th>\r\n                                        <th>Status</th>\r\n                                        <th></th>\r\n                                        <th></th>\r\n                                    </tr>\r\n                                </tfoot>\r\n                                <tbody></tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \r\n   \r\n            \r\n        \r\n        <div class=\"sk-circle-layer\">\r\n            <div class=\"sk-circle\">\r\n                <div class=\"sk-circle1 sk-child\"></div>\r\n                <div class=\"sk-circle2 sk-child\"></div>\r\n                <div class=\"sk-circle3 sk-child\"></div>\r\n                <div class=\"sk-circle4 sk-child\"></div>\r\n                <div class=\"sk-circle5 sk-child\"></div>\r\n                <div class=\"sk-circle6 sk-child\"></div>\r\n                <div class=\"sk-circle7 sk-child\"></div>\r\n                <div class=\"sk-circle8 sk-child\"></div>\r\n                <div class=\"sk-circle9 sk-child\"></div>\r\n                <div class=\"sk-circle10 sk-child\"></div>\r\n                <div class=\"sk-circle11 sk-child\"></div>\r\n                <div class=\"sk-circle12 sk-child\"></div>\r\n            </div>\r\n        </div>\r\n    </body>\r\n</html>\r\n\r\n";

?>